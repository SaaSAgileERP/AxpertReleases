/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function ownKeys(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?ownKeys(Object(t),!0).forEach(function(o){_defineProperty(e,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})}return e}function _defineProperty(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var applstJson="",handlerType="",redislstJson="",isFile="false",isArm="false";function OpenSignIn(){window.document.location.href="Signin.aspx"}function TestConnection(){var e=$("#ddldbtype").val();if(""==e)return $("#ddldbtype").focus(),showAlertDialog("error","Database name should not be left empty."),!1;var o=$("#ddldbversion").val();return"ms sql"==e.toLowerCase()&&""==o?($("#ddldbversion").focus(),showAlertDialog("error","Database verion should not be left empty."),!1):""==$("#txtccname").val()?($("#txtccname").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):""==$("#txtusername").val()?($("#txtusername").focus(),showAlertDialog("error","User name should not be left empty."),!1):""==$("#txtPassword").val()?($("#txtPassword").focus(),showAlertDialog("error","Password should not be left empty."),!1):void TestConnectionWs()}function TestConnectionWs(){$.ajax({url:"Config.aspx/AppTestConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({ddldbtype:$("#ddldbtype").val(),ddldbversion:$("#ddldbversion").val(),ddldriver:$("#ddldriver").val(),txtccname:$("#txtccname").val(),txtusername:$("#txtusername").val(),txtPassword:$("#txtPassword").val()}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var o=$.parseJSON(e.d);"true"==o.result[0].result?(showAlertDialog("success","Test Connection was Successful."),EnableApplyConnection()):showAlertDialog("error",o.result[0].error.msg)}else showAlertDialog("error",e.d)},error:function(e){showAlertDialog("error",e)}})}function EnableApplyConnection(){$("#btnApply").removeAttr("disabled").removeClass("btndisable"),$("#btnChangePassword").removeAttr("disabled").removeClass("btndisable")}function applyconnection(){var e=$("#txtNewConName").val();return""==e?($("#txtNewConName").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):!!new RegExp("^[a-zA-Z0-9]+$").test(e)||($("#txtNewConName").focus(),showAlertDialog("error","Invalid Name - Special characters not allowed."),!1)}function applydbpwdconnection(){var e=$("#txtNewPassword").val();if(""==e)return $("#txtNewPassword").focus(),showAlertDialog("error","Password can not be empty."),!1;var o=$("#txtConfirmPassword").val();return""==o?($("#txtConfirmPassword").focus(),showAlertDialog("error","Confirm Password can not be empty."),!1):e==o||($("#txtNewPassword").focus(),showAlertDialog("error","The password you entered did not match."),!1)}function SuccApplyConnection(e,o){"success"==e?showAlertDialog("success","Connection is created successful."):showAlertDialog("error","Connection Name already exists.")}function SuccPasswordChange(e,o){"success"==e?showAlertDialog("success",o):showAlertDialog("error",o)}function setProjectImages(e){var o="../images/loginlogo.png",t="../AxpImages/login-img.png",n="../AxpImages/login-img.png",s=$(".file-upload[data-type=logo]").parent().parent().find(".profile-pic"),l=$(".file-upload[data-type=webbg]").parent().parent().find(".profile-pic"),a=$(".file-upload[data-type=mobbg]").parent().parent().find(".profile-pic");e?getProjectAppLogo(e,async=!0,function(e){if(null!=e&&e.d){var r=JSON.parse(e.d),i=r.logo,d=r.webbg,c=r.mobbg,p=!1;d&&!c&&(c=d,p=!0),s.prop("src",i?"".concat(i,"?v=").concat((new Date).getTime()):o),l.prop("src",d||t),a.prop("src",c||n),i?s.parent().find(".delete-button").removeClass("d-none"):s.parent().find(".delete-button").addClass("d-none"),d?l.parent().find(".delete-button").removeClass("d-none"):l.parent().find(".delete-button").addClass("d-none"),c&&!p?a.parent().find(".delete-button").removeClass("d-none"):a.parent().find(".delete-button").addClass("d-none")}else s.prop("src",o),l.prop("src",t),a.prop("src",n),s.parent().find(".delete-button").addClass("d-none"),l.parent().find(".delete-button").addClass("d-none"),a.parent().find(".delete-button").addClass("d-none")},function(e){s.prop("src",o),l.prop("src",t),a.prop("src",n),s.parent().find(".delete-button").addClass("d-none"),l.parent().find(".delete-button").addClass("d-none"),a.parent().find(".delete-button").addClass("d-none")}):(s.prop("src",o),l.prop("src",t),a.prop("src",n),s.nextAll(".delete-button").addClass("hide"),l.nextAll(".delete-button").addClass("hide"),a.nextAll(".delete-button").addClass("hide"))}function licActivateCheck(){$("#btnActivate").hasClass("disabledButton")||(""==$("#txtlicappkey").val()?($("#txtlicappkey").focus(),showAlertDialog("error","Please enter license key provided by Agile Labs...")):$("#btnActivateasp").trigger("click"))}function licRefreshCheck(){$("#btnRefresh").hasClass("disabledButton")||$("#btnRefreshasp").trigger("click")}function licTrialCheck(){$("#btnTrial").hasClass("disabledButton")||$("#btnTrialasp").trigger("click")}function offlinelicDownload(){""==$("#txtlicofflinekey").val()?($("#txtlicofflinekey").focus(),showAlertDialog("error","Please enter license key provided by Agile Labs...")):$("#btnDownloadasp").trigger("click")}function LicActivationSucc(e,o){"success"==e?(showAlertDialog("success",o),setTimeout(function(){var e=window.document.location.href;window.document.location.href=e},300)):showAlertDialog("error",o)}function LicDownloadSucc(e,o){"success"==e?(showAlertDialog("success",o),$("#btndownloadfile").trigger("click")):showAlertDialog("error",o)}function closeUploadDialog(){$("#btnFileUpload").prop("disabled",!1),$("#filMyFile").val(""),$("#lblnofilename").text(""),$("#myModalLicUpload").hide()}function uploadLogo(e){for(var o=e.target,t=o.files,n=new FormData,s=0;s<t.length;s++)n.append(t[s].name,t[s]);var l,a=location.origin+location.pathname.substr(0,location.pathname.indexOf("aspx"));$("#axSelectProj").val()?$.ajax({url:a+"ProjectImageUploadHandler.ashx?proj=".concat($("#axSelectProj").val(),"&type=").concat((null==o?void 0:null===(l=o.dataset)||void 0===l?void 0:l.type)||"","&handlertype=").concat(handlerType),type:"POST",data:n,contentType:!1,processData:!1,success:function(e){handlerType="upload",e.indexOf("success")>-1?(setProjectImages($("#axSelectProj").val()),showAlertDialog("success",e)):e.indexOf("size")>-1||e.indexOf("select")?showAlertDialog("warning",e):(e.indexOf("error"),showAlertDialog("error",e)),$(o).val("")},error:function(e){handlerType="upload",showAlertDialog("error",e.statusText),$(o).val("")}}):(handlerType="upload",showAlertDialog("error","Project Name should be selected"))}function AuthenticateUser(){return""==$("#txtAuthUsername").val()?($("#txtAuthUsername").focus(),showAlertDialog("error","User name should not be left empty."),!1):""==$("#txtAuthPwd").val()?($("#txtAuthPwd").focus(),showAlertDialog("error","Password should not be left empty."),!1):void $.ajax({url:"Config.aspx/UserAuthentication",type:"POST",cache:!1,async:!0,data:JSON.stringify({AuthUsername:$("#txtAuthUsername").val(),AuthPwd:$("#txtAuthPwd").val()}),dataType:"json",contentType:"application/json",success:function(e){if($("#configbody").removeClass("m-auto"),$("#main_body").removeAttr("style"),""!=e.d){var o=window.document.location.href;if(o.indexOf("?")>-1){var t=o.split("?")[1];if(t.indexOf("auth=")>-1){var n="";t.split("&").forEach(function(e){-1==e.indexOf("auth=")&&(n+=e+"&")}),window.document.location.href="config.aspx?"+n+"auth="+e.d}else window.document.location.href=o+"&auth="+e.d}else window.document.location.href="config.aspx?auth="+e.d}else showAlertDialog("error","Incorrect credentials. please try again!")},error:function(e){showAlertDialog("error",e)}})}function initUiPanel(){$("#axSelectProj").val(selProj),setProjectImages(selProj);$("#lstconnection option").toArray().map(function(e){return{label:e.value,value:e.value,link:""}});$("#axSelectProj").select2({data:applstJson}).on("select2:select",function(e){var o,t;((null===(o=appGlobalVarsObject)||void 0===o?void 0:null===(t=o._CONSTANTS)||void 0===t?void 0:t.window)||window).toastr.clear(),setProjectImages($(this).val())})}function applyRedisconnection(){return""==$("#txtrhotname").val()?($("#txtrhotname").focus(),showAlertDialog("error","Host name should not be left empty."),!1):""==$("#txtrport").val()?($("#txtrport").focus(),showAlertDialog("error","Port should not be left empty."),!1):void TestRedisConnectionWs()}function EnableRedisApplyConnection(){$("#btnRedisApply").removeAttr("disabled").removeClass("btndisable")}function SuccRedisConnection(e){"success"==e?showAlertDialog("success","Connection is created successful."):showAlertDialog("error","Connection Name already exists.")}function TestRedisConnectionWs(){$.ajax({url:"Config.aspx/RedisTestConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({rHost:$("#txtrhotname").val(),rPort:$("#txtrport").val(),rPwd:$("#txtrpwd").val()}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d)if("true:yes"==e.d)$("#hdnRPwd").val("true"),showAlertDialog("success","Test Connection was Successful."),EnableRedisApplyConnection();else if("true:no"==e.d)$("#hdnRPwd").val("false"),showAlertDialog("success","Test Connection was Successful."),EnableRedisApplyConnection();else{$("#hdnRPwd").val("true"),""==$("#txtrpwd").val()?showAlertDialog("error","Test Connection failed. Please enter password and try again."):showAlertDialog("error","Test Connection failed."),$("#btnRedisApply").attr("disabled","true").addClass("btndisable")}else $("#hdnRPwd").val("true"),showAlertDialog("error","Test Connection failed."),$("#btnRedisApply").attr("disabled","true").addClass("btndisable")},error:function(e){$("#hdnRPwd").val("true"),showAlertDialog("error",e)}})}function TestARMConnectionWs(){var e=$("#hdnprojarm").val();return-1!=e.indexOf("\\")&&(e=e.split("\\")[0]),""===$.trim(e)?showAlertDialog("error","Project cannot be left empty"):""===$.trim($("#txtarmkey").val())?showAlertDialog("error","ARMPrivate Key cannot be left empty"):""===$.trim($("#txtarmurl").val())?showAlertDialog("error","ARM URL cannot be left empty"):""===$.trim($("#txtscripturl").val())?showAlertDialog("error","ARM Scripts URL cannot be left empty"):""===$.trim($("#txtpeg").val())?showAlertDialog("error","PEG cannot be left empty"):void $.ajax({url:"Config.aspx/ARMConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({aKey:$("#txtarmkey").val(),aUrl:$("#txtarmurl").val(),aScriptsUrl:$("#txtscripturl").val(),aPeg:$("#txtpeg").val(),proj:e}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","ARM Connection is saved successfully"),armlist=e.d)},error:function(e){showAlertDialog("error",e)}})}function DelARMConnectionWs(){var e=$("#hdnprojarm").val();-1!=e.indexOf("\\")&&(e=e.split("\\")[0]),$.ajax({url:"Config.aspx/DelARMConnectionWs",type:"POST",cache:!1,async:!0,data:JSON.stringify({proj:e}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","ARM Connection is deleted successfully"),document.getElementById("txtarmkey").value="",document.getElementById("txtarmurl").value="",document.getElementById("txtscripturl").value="",document.getElementById("txtpeg").value="",$("#txtpeg").trigger("change"),armlist=e.d)},error:function(e){showAlertDialog("error",e)}})}function TestFileConnectionWs(){var e=$("#hdnfileproj").val();return-1!=e.indexOf("\\")&&(e=e.split("\\")[0]),""===$.trim(e)?showAlertDialog("error","Project cannot be left empty"):""===$.trim($("#txtfileupload").val())?showAlertDialog("error","File Upload Path cannot be left empty"):""===$.trim($("#txtfiledownload").val())?showAlertDialog("error","File Download Path cannot be left empty"):void $.ajax({url:"Config.aspx/FileConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({fUpload:$("#txtfileupload").val(),fDownload:$("#txtfiledownload").val(),proj:e,fMapUsername:$("#txtfileMapUsername").val(),fMapPwd:$("#tstfileMapPwd").val()}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","File Connection is saved successfully"),filelist=e.d)},error:function(e){showAlertDialog("error",e)}})}function DelFileConnectionWs(){var e=$("#hdnfileproj").val();-1!=e.indexOf("\\")&&(e=e.split("\\")[0]),$.ajax({url:"Config.aspx/DelFileConnectionWs",type:"POST",cache:!1,async:!0,data:JSON.stringify({proj:e}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","File Connection is deleted successfully"),document.getElementById("txtfileupload").value="",document.getElementById("txtfiledownload").value="",document.getElementById("txtfileMapUsername").value="",document.getElementById("tstfileMapPwd").value="",filelist=e.d)},error:function(e){showAlertDialog("error",e)}})}function CreateRedisConnection(){var e=$("#txtRedisNewConn").val();return""==e?($("#txtRedisNewConn").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):new RegExp("^[a-zA-Z0-9]+$").test(e)?void 0:($("#txtRedisNewConn").focus(),showAlertDialog("error","Invalid Name - Special characters not allowed."),!1)}function SaveSSOConnectionWs(){var proj=$("#hdnssoProj").val();if(-1!=proj.indexOf("\\")&&(proj=proj.split("\\")[0]),""===$.trim(proj))return showAlertDialog("error","Project cannot be left empty");var _ssoType=$("#ssoType").val();if($("#hdnssoType").val(_ssoType),void 0===_ssoType||""==_ssoType)return showAlertDialog("error","SSO Type cannot be left empty");var ssoOptionWindow=1==$("#ssoOptionWindow").is(":checked")?"true":"false",requestData={};if("windows"==_ssoType){if(""===$.trim($("#ssowindowsdomain").val()))return showAlertDialog("error","Windows Domain Name cannot be left empty");requestData={ssoType:_ssoType,ssoWinDomain:$("#ssowindowsdomain").val(),onlysso:ssoOptionWindow}}else if("saml"==_ssoType){if(""===$.trim($("#SamlPartnerIdP").val()))return showAlertDialog("error","SAML Partnet IDP cannot be left empty");if(""===$.trim($("#SamlIdentifier").val()))return showAlertDialog("error","SAML Identifier cannot be left empty");if(""===$.trim($("#SamlCertificate").val()))return showAlertDialog("error","SAML Certificate cannot be left empty");if(""===$.trim($("#ssoredirecturlsaml").val()))return showAlertDialog("error","SAML Redirect URL cannot be left empty");requestData={ssoType:_ssoType,SamlPartnerIdP:$("#SamlPartnerIdP").val(),SamlIdentifier:$("#SamlIdentifier").val(),SamlCertificate:$("#SamlCertificate").val(),SamlRedirectUrl:$("#ssoredirecturlsaml").val(),onlysso:ssoOptionWindow}}else if("office365"==_ssoType){if(""===$.trim($("#of365ssoclientKey").val()))return showAlertDialog("error","Office365 Client Key cannot be left empty");if(""===$.trim($("#of365ssoclientsecretKey").val()))return showAlertDialog("error","Office365 Secret Key cannot be left empty");if(""===$.trim($("#ssoredirecturlof365").val()))return showAlertDialog("error","Office365 Redirect URL cannot be left empty");requestData={ssoType:_ssoType,of365clientkey:$("#of365ssoclientKey").val(),of365secretkey:$("#of365ssoclientsecretKey").val(),of365redirecturl:$("#ssoredirecturlof365").val(),onlysso:ssoOptionWindow}}else if("okta"==_ssoType){if(""===$.trim($("#ssoclientKeyokta").val()))return showAlertDialog("error","OKAT Client Key cannot be left empty");if(""===$.trim($("#ssoclientsecretKeyokta").val()))return showAlertDialog("error","OKTA Secret Key cannot be left empty");if(""===$.trim($("#ssooktadomain").val()))return showAlertDialog("error","OKTA Domain cannot be left empty");if(""===$.trim($("#ssoredirecturlokta").val()))return showAlertDialog("error","OKTA Redirect URL cannot be left empty");requestData={ssoType:_ssoType,oktaclientkey:$("#ssoclientKeyokta").val(),oktasecretkey:$("#ssoclientsecretKeyokta").val(),oktadomain:$("#ssooktadomain").val(),oktaredirecturl:$("#ssoredirecturlokta").val(),onlysso:ssoOptionWindow}}else if("google"==_ssoType){if(""===$.trim($("#ssoclientKeygoogle").val()))return showAlertDialog("error","Google Client Key cannot be left empty");if(""===$.trim($("#ssoclientsecretKeygoogle").val()))return showAlertDialog("error","Google Secret Key cannot be left empty");if(""===$.trim($("#ssoredirecturlgoogle").val()))return showAlertDialog("error","Google Redirect URL cannot be left empty");requestData={ssoType:_ssoType,googleclientkey:$("#ssoclientKeygoogle").val(),googlesecretkey:$("#ssoclientsecretKeygoogle").val(),googleredirecturl:$("#ssoredirecturlgoogle").val(),onlysso:ssoOptionWindow}}else if("facebook"==_ssoType){if(""===$.trim($("#ssoclientKeyfb").val()))return showAlertDialog("error","Facebook Client Key cannot be left empty");if(""===$.trim($("#ssoclientsecretKeyfb").val()))return showAlertDialog("error","Facebook Secret Key cannot be left empty");if(""===$.trim($("#ssoredirecturlfb").val()))return showAlertDialog("error","Facebook Redirect URL cannot be left empty");requestData={ssoType:_ssoType,fbclientkey:$("#ssoclientKeyfb").val(),fbsecretkey:$("#ssoclientsecretKeyfb").val(),fbredirecturl:$("#ssoredirecturlfb").val(),onlysso:ssoOptionWindow}}else if("openid"==_ssoType){if(""===$.trim($("#ssoclientKeyOpenId").val()))return showAlertDialog("error","OpenID Client Key cannot be left empty");if(""===$.trim($("#ssoclientsecretKeyOpenId").val()))return showAlertDialog("error","OpenID Secret Key cannot be left empty");if(""===$.trim($("#ssoopeniddomain").val()))return showAlertDialog("error","OpenID Domain cannot be left empty");if(""===$.trim($("#ssoredirecturlopenid").val()))return showAlertDialog("error","OpenID Redirect URL cannot be left empty");requestData={ssoType:_ssoType,openidclientkey:$("#ssoclientKeyOpenId").val(),openidsecretkey:$("#ssoclientsecretKeyOpenId").val(),openiddomain:$("#ssoopeniddomain").val(),openidredirecturl:$("#ssoredirecturlopenid").val(),onlysso:ssoOptionWindow}}if("true"==ssoOptionWindow)if(""!=SSOlistcon){var cleanedSSOlistcon=SSOlistcon.trim();cleanedSSOlistcon=cleanedSSOlistcon.replace(/^"|"$/g,""),cleanedSSOlistcon=cleanedSSOlistcon.replace(/\\r\\n|\\n|\\r/g,""),cleanedSSOlistcon=cleanedSSOlistcon.replace(/\\"/g,'"');var _SSOlistcon=JSON.parse(cleanedSSOlistcon),projectData=_SSOlistcon[proj],existingOnlySSO=null;for(var ssoType in projectData)"true"===projectData[ssoType].onlysso&&(existingOnlySSO=ssoType);if(existingOnlySSO&&existingOnlySSO!==_ssoType)var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:"Only SSO login can be enabled for a single SSO. Do you want to continue?",buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){var e={};e[existingOnlySSO]=_objectSpread({},projectData[existingOnlySSO]),e[existingOnlySSO].onlysso="false",$.ajax({url:"Config.aspx/SaveUpdateSSOConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({requestJson:requestData,ssoType:_ssoType,ssoProj:proj,updatereqJson:e,updateSsoType:existingOnlySSO}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","SSO Connection is saved successfully"),SSOlistcon=e.d,window.location.href=window.location.href)},error:function(e){showAlertDialog("error",e)}})}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}});else $.ajax({url:"Config.aspx/SaveSSOConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({requestJson:requestData,ssoType:_ssoType,ssoProj:proj}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","SSO Connection is saved successfully"),SSOlistcon=e.d,window.location.href=window.location.href)},error:function(e){showAlertDialog("error",e)}})}else $.ajax({url:"Config.aspx/SaveSSOConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({requestJson:requestData,ssoType:_ssoType,ssoProj:proj}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","SSO Connection is saved successfully"),SSOlistcon=e.d,window.location.href=window.location.href)},error:function(e){showAlertDialog("error",e)}});else $.ajax({url:"Config.aspx/SaveSSOConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({requestJson:requestData,ssoType:_ssoType,ssoProj:proj}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&(showAlertDialog("success","SSO Connection is saved successfully"),SSOlistcon=e.d,window.location.href=window.location.href)},error:function(e){showAlertDialog("error",e)}})}function existtingSSOInfo(e,o){if(""!=SSOlistcon){var t=SSOlistcon.trim();t=(t=(t=t.replace(/^"|"$/g,"")).replace(/\\r\\n|\\n|\\r/g,"")).replace(/\\"/g,'"');var n=JSON.parse(t);"windows"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssowindowsdomain").val(n[e][o].ssoWinDomain)):"saml"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#SamlPartnerIdP").val(n[e][o].SamlPartnerIdP),$("#SamlIdentifier").val(n[e][o].SamlIdentifier),$("#SamlCertificate").val(n[e][o].SamlCertificate),$("#ssoredirecturlsaml").val(n[e][o].SamlRedirectUrl)):"office365"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#of365ssoclientKey").val(n[e][o].of365clientkey),$("#of365ssoclientsecretKey").val(n[e][o].of365secretkey),$("#ssoredirecturlof365").val(n[e][o].of365redirecturl)):"okta"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssoclientKeyokta").val(n[e][o].oktaclientkey),$("#ssoclientsecretKeyokta").val(n[e][o].oktasecretkey),$("#ssooktadomain").val(n[e][o].oktadomain),$("#ssoredirecturlokta").val(n[e][o].oktaredirecturl)):"google"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssoclientKeygoogle").val(n[e][o].googleclientkey),$("#ssoclientsecretKeygoogle").val(n[e][o].googlesecretkey),$("#ssoredirecturlgoogle").val(n[e][o].googleredirecturl)):"google"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssoclientKeygoogle").val(n[e][o].googleclientkey),$("#ssoclientsecretKeygoogle").val(n[e][o].googlesecretkey),$("#ssoredirecturlgoogle").val(n[e][o].googleredirecturl)):"facebook"==o?($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssoclientKeyfb").val(n[e][o].fbclientkey),$("#ssoclientsecretKeyfb").val(n[e][o].fbsecretkey),$("#ssoredirecturlfb").val(n[e][o].fbredirecturl)):"openid"==o&&($("#ssoOptionWindow").prop("checked","true"==n[e][o].onlysso),$("#ssoclientKeyOpenId").val(n[e][o].openidclientkey),$("#ssoclientsecretKeyOpenId").val(n[e][o].openidsecretkey),$("#ssoopeniddomain").val(n[e][o].openiddomain),$("#ssoredirecturlopenid").val(n[e][o].openidredirecturl))}}$j(document).ready(function(){if($("#lstconnection").select2(),$("#lstRconnection").select2(),$("#ddldbtype").select2(),$("#ddldbversion").select2(),$("#lstconnection").val(selProj).trigger("change"),$("#btnaddcon").click(function(){$("#lstconnection").val("").trigger("change"),$("#ddldbtype").val("").trigger("change"),$("#ddldbversion").val("").trigger("change")}),"false"==IsLicExist?($("#dvlicmessage").show(),$("#btnRefresh").hide(),$("#btnActivate").show(),$("#btnTrial").show(),$(".licActOptions").show(),$("#dvdbConnection").addClass("disabledDiv")):($("#dvlicmessage").hide(),$(".licActOptions").hide(),$("#btnRefresh").show(),$("#btnActivate").hide(),$("#btnTrial").hide(),$("#dvdbConnection").removeClass("disabledDiv")),redislist=ReverseCheckSpecialChars(redislist),""!=redislist){var e=parseXml(redislist);if(""!=(redislstJson=JSON.parse(xml2json(e,"")))){var o=$("#lstRconnection option:first").val();if(void 0!==o){var t=redislstJson.axp_rconn[o].host,n=redislstJson.axp_rconn[o].port;redislstJson.axp_rconn[o].pwd;$("#txtrhotname").val(t),$("#txtrport").val(n),$("#txtrpwd").val(""),$("#lstRconnection").val(o),$("#lstRconnection").trigger("change")}}}if($("#ddldbversion").val(i).prop("disabled",!0),applist=ReverseCheckSpecialChars(applist),""!=applist){var s=parseXml(applist);if(applstJson=JSON.parse(xml2json(s,"")),""!=selProj&&""!=applstJson){$("#lstconnection").val(selProj).focus();var l=applstJson.connections[selProj].db,a=applstJson.connections[selProj].dbcon,r=applstJson.connections[selProj].dbuser,i=null==applstJson.connections[selProj].version?"":applstJson.connections[selProj].version,d=applstJson.connections[selProj].driver;$("#lblconname").text(selProj),$("#ddldbtype").val(l).trigger("change"),"MS SQL"!=l.toString()&&$(".databasever").addClass("d-none"),""!=i?$("#ddldbversion").val(i).prop("disabled",!1):$("#ddldbversion").val(i).prop("disabled",!0),$("#txtccname").val(a),$("#txtusername").val(r),$("#ddldriver").val(d)}else if(""!=applstJson){var c=$("#lstconnection option:first").val();if(void 0!==c){$("#lstconnection").val(c).focus();l=applstJson.connections[c].db,a=applstJson.connections[c].dbcon,r=applstJson.connections[c].dbuser,i=null==applstJson.connections[c].version?"":applstJson.connections[c].version,d=applstJson.connections[c].driver;$("#lblconname").text(c),$("#ddldbtype").val(l).trigger("change"),""!=i?$("#ddldbversion").val(i).prop("disabled",!1):$("#ddldbversion").val(i).prop("disabled",!0),$("#txtccname").val(a),$("#txtusername").val(r),$("#ddldriver").val(d)}}}if(""!=applstJson){var p=$("#armproj option:first").val();if(void 0!==p){$("#armproj").val(p).focus(),$("#armproj").trigger("change");var u=p;if(-1!=u.indexOf("\\")&&(u=u.split("\\")[0]),$("#hdnprojarm").val(u),armlist=armlist.replace('"{\r\n',"{\r\n").replace('\r\n}"',"\r\n}").replaceAll("\r\n",""),""!=armlist){var f=JSON.parse(armlist);f.hasOwnProperty(u)&&(document.getElementById("txtarmkey").value=f[u].ARM_PrivateKey,document.getElementById("txtarmurl").value=f[u].ARM_URL,document.getElementById("txtscripturl").value=f[u].ARM_Scripts_URL,document.getElementById("txtpeg").value=f[u].PEG,$("#txtpeg").trigger("change"))}}}if(""!=applstJson){var v=$("#fileproj option:first").val();if(void 0!==v){$("#fileproj").val(v).focus(),$("#fileproj").trigger("change");var m=v;if(-1!=m.indexOf("\\")&&(m=m.split("\\")[0]),$("#hdnfileproj").val(m),filelist=filelist.replace('"{\r\n',"{\r\n").replace('\r\n}"',"\r\n}").replaceAll("\r\n",""),""!=filelist){var g=JSON.parse(filelist);g.hasOwnProperty(m)&&(document.getElementById("txtfileupload").value=g[m].FileUploadPath,document.getElementById("txtfiledownload").value=g[m].FileDownloadPath,document.getElementById("txtfileMapUsername").value=g[m].FileServerMapUsername,document.getElementById("tstfileMapPwd").value=g[m].FileServerMapPwd)}}}$(document).on("click",".upload-button",function(e){try{if(""==$("#axSelectProj").val())return showAlertDialog("warning","Please Select UI Configuration Project"),$("#axSelectProj").focus(),e.preventDefault(),e.stopPropagation(),!1;handlerType="upload",$(e.currentTarget).nextAll(".file-upload").trigger("click")}catch(o){}}),$(document).on("click",".delete-button",function(e){try{if(""==$("#axSelectProj").val())return showAlertDialog("warning","Please Select UI Configuration Project"),$("#axSelectProj").focus(),e.preventDefault(),e.stopPropagation(),!1;handlerType="delete",$(e.currentTarget).parent().find(".file-upload").trigger("change")}catch(o){}}),$(document).on("change",".file-upload",function(e){uploadLogo(e)}),$("#ddlIsNewConnection").val("new"),$("#txtNewConName").val(""),$("#ddlIsRedisNewConnection").val("new"),$("#txtRedisNewConn").val(""),$("#demo").on("hide.bs.collapse",function(){$(".licInfoAccordion").html('<span class="material-icons">expand_more</span>')}),$("#demo").on("show.bs.collapse",function(){$(".licInfoAccordion").html('<span class="material-icons">expand_less</span>')}),"false"==IsLicExist&&($("#demo").addClass("in"),$(".licInfoAccordion").html('<span class="material-icons">expand_less</span>')),$("#filMyFile").bind({change:function(){var e=$("#filMyFile").val();/^\s*$/.test(e)?($(".file-upload").removeClass("active"),$("#lblfuerror").text("No file chosen...")):$(".file-upload").addClass("active");var o=e.split(".").pop().toLowerCase();-1==$.inArray(o,["lic"])?($("#btnFileUpload").prop("disabled",!0),$("#lblfuerror").text("Invalid file format.")):($("#btnFileUpload").prop("disabled",!1),$("#lblfuerror").text(""));var t=$("#filMyFile")[0].files;t.length>0&&$("#lblnofilename").text(t[0].name)}}),"true"==authPopup&&$("#myModalAuth").show(),initUiPanel()}),$j(document).on("click","#lstconnection option",function(e){var o=$(this).val();if(""!=applstJson){var t=applstJson.connections[o].db,n=applstJson.connections[o].dbcon,s=applstJson.connections[o].dbuser,l=null==applstJson.connections[o].version?"":applstJson.connections[o].version,a=applstJson.connections[o].driver;$("#lblconname").text(o),$("#ddldbtype").val(t),""!=t&&$("#ddldbtype").val(t).trigger("change"),""!=l?($("#ddldbversion").val(l).prop("disabled",!1),$("#ddldbversion").val(l).trigger("change")):$("#ddldbversion").val(l).prop("disabled",!0),$("#txtccname").val(n),$("#txtusername").val(s),$("#ddldriver").val(a)}}),$j(document).on("change","#lstconnection",function(e){var o=$(this).val();if(""!=applstJson&&null!=o){var t=applstJson.connections[o].db,n=applstJson.connections[o].dbcon,s=applstJson.connections[o].dbuser,l=null==applstJson.connections[o].version?"":applstJson.connections[o].version,a=applstJson.connections[o].driver;$("#lblconname").text(o),$("#ddldbtype").val(t),$("#ddldbtype").trigger("change"),""!=t&&$("#ddldbtype").val(t).trigger("change"),"ms sql"!=t.toString().toLowerCase()?($("#ddldbversion").val("").trigger("change"),$(".databasever").addClass("d-none")):$(".databasever").removeClass("d-none"),""!=l?($("#ddldbversion").val(l).prop("disabled",!1),$("#ddldbversion").val(l).trigger("change")):$("#ddldbversion").val(l).prop("disabled",!0),$("#txtccname").val(n),$("#txtusername").val(s),$("#ddldriver").val(a)}}),$j(document).on("change","#fileproj",function(e){var o=$(this).val();if(""!=applstJson){var t=o;-1!=t.indexOf("\\")&&(t=t.split("\\")[0]),$("#hdnfileproj").val(t),-1==filelist.indexOf("\\r\\n")&&-1==filelist.indexOf("\r\n")&&"false"==isFile&&(filelist=filelist.slice(1,-1)),-1!=filelist.indexOf("\\r\\n")?filelist=filelist.replace('"{\\r\\n',"{\\r\\n").replace('\\r\\n}"',"\\r\\n}").replaceAll("\\r\\n","").replaceAll("\\",""):filelist=filelist.replace('"{\r\n',"{\r\n").replace('\r\n}"',"\r\n}").replaceAll("\r\n","");try{if(""!=filelist){var n=JSON.parse(filelist);isFile="true",n.hasOwnProperty(t)?(document.getElementById("txtfileupload").value=n[t].FileUploadPath,document.getElementById("txtfiledownload").value=n[t].FileDownloadPath,document.getElementById("txtfileMapUsername").value=n[t].FileServerMapUsername,document.getElementById("tstfileMapPwd").value=n[t].FileServerMapPwd):(document.getElementById("txtfileupload").value="",document.getElementById("txtfiledownload").value="",document.getElementById("txtfileMapUsername").value="",document.getElementById("tstfileMapPwd").value="")}}catch(s){}}}),$j(document).on("change","#armproj",function(e){var o=$(this).val();if(""!=applstJson){var t=o;-1!=t.indexOf("\\")&&(t=t.split("\\")[0]),$("#hdnprojarm").val(t),-1==armlist.indexOf("\\r\\n")&&-1==armlist.indexOf("\r\n")&&"false"==isArm&&(armlist=armlist.slice(1,-1)),-1!=armlist.indexOf("\\")&&(armlist=armlist.replaceAll("\\","")),-1!=armlist.indexOf("\\r\\n")?armlist=armlist.replace('"{\\r\\n',"{\\r\\n").replace('\\r\\n}"',"\\r\\n}").replaceAll("\\r\\n","").replaceAll("\\",""):armlist=armlist.replace('"{\r\n',"{\r\n").replace('\r\n}"',"\r\n}").replaceAll("\r\n","");try{if(""!=armlist){var n=JSON.parse(armlist);isArm="true",n.hasOwnProperty(t)?(document.getElementById("txtarmkey").value=n[t].ARM_PrivateKey,document.getElementById("txtarmurl").value=n[t].ARM_URL,document.getElementById("txtscripturl").value=n[t].ARM_Scripts_URL,document.getElementById("txtpeg").value=n[t].PEG,$("#txtpeg").trigger("change")):(document.getElementById("txtarmkey").value="",document.getElementById("txtarmurl").value="",document.getElementById("txtscripturl").value="",document.getElementById("txtpeg").value="",$("#txtpeg").trigger("change"))}}catch(s){}}}),$j(document).on("click","#btnApply",function(e){null==$("#lstconnection").val()||""==$("#lstconnection").val()?($("#ddlIsNewConnection").val("new"),$("#myModal").modal("show")):($("#ddlIsNewConnection").val("old"),$("#txtNewConName").val($("#lstconnection").val()),$("#btnok").click())}),$j(document).on("click","#btnChangePassword",function(e){$("#myModaldbpassword").modal("show")}),$j(document).on("click","#btnCancel",function(e){window.document.location.href="signin.aspx"}),$j(document).on("click","#btnaddcon",function(e){$("#ddldbtype").prop("selectedIndex",0),$("#ddldbversion").prop("selectedIndex",0).prop("disabled",!0),$(".databasever").removeClass("d-none"),$("#ddldriver").prop("selectedIndex",0),$("#lblconname").text(""),$("#txtccname").val(""),$("#txtusername").val(""),$("#lstconnection").val(""),$("#txtPassword").val(""),$("#txtNewPassword").val(""),$("#txtConfirmPassword").val("")}),$j(document).on("click","#btncdelete",function(e){var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[512]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$j("#btndelete").click()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}),$j(document).on("change","#ddldbtype",function(e){"MS SQL"==$(this).val()?($("#ddldbversion").prop("disabled",!1),$("#ddldriver").val("ado")):($("#ddldbversion").val("").prop("disabled",!0),$("#ddldriver").val("dbx"))}),$j(document).on("click","#btnlicactivation",function(e){window.document.location.href="licactivation.aspx"}),$j(document).on("click","#btnnewcancel,#myModalclose",function(e){$("#myModal").hide(),$("#btnApply").attr("disabled",!0).addClass("btndisable"),$("#btnChangePassword").attr("disabled",!0).addClass("btndisable")}),$j(document).on("click","#btndbpwdcancel,#myModaldbpasswordclose",function(e){$("#myModaldbpassword").hide(),$("#btnApply").attr("disabled",!0).addClass("btndisable"),$("#btnChangePassword").attr("disabled",!0).addClass("btndisable")}),$j(document).on("click","#btnUpload",function(e){$("#myModalLicUpload").show()}),$j(document).on("change","#rbllictype input",function(e){switch($(this).val()){case"offline":$("#dvOffline").show(),$("#dvOnline").hide();break;default:$("#dvOffline").hide(),$("#dvOnline").show()}}),$j(document).on("click","#btnAuthCancel,#myModalAuthClose",function(e){window.document.location.href="signin.aspx"}),$j(document).on("click","#btnRedisApply",function(e){null==$("#lstRconnection").val()||""==$("#lstRconnection").val()?($("#ddlIsRedisNewConnection").val("new"),$("#myModalRedis").modal("show")):($("#ddlIsRedisNewConnection").val("old"),$("#txtRedisNewConn").val($("#lstRconnection").val()),$("#btnRedisOk").click())}),$j(document).on("click","#lstRconnection option",function(e){var o=$(this).val();if(""!=redislstJson){var t=redislstJson.axp_rconn[o].host,n=redislstJson.axp_rconn[o].port;redislstJson.axp_rconn[o].pwd;$("#txtrhotname").val(t),$("#txtrport").val(n),$("#txtrpwd").val("")}}),$j(document).on("change","#lstRconnection",function(e){var o=$(this).val();if(""!=redislstJson&&null!=o){var t=redislstJson.axp_rconn[o].host,n=redislstJson.axp_rconn[o].port;redislstJson.axp_rconn[o].pwd;$("#txtrhotname").val(t),$("#txtrport").val(n),$("#txtrpwd").val("")}}),$j(document).on("click","#btnRedisAdd",function(e){$("#txtrhotname").val(""),$("#txtrport").val(""),$("#txtrpwd").val(""),$("#lstRconnection").val("").trigger("change")}),$j(document).on("click","#btnRcdelete",function(e){var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[522]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$j("#btnRedisdelete").click()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}),$j(document).on("click","#btnrnewcancel,#myModalRedisclose",function(e){$("#myModalRedis").modal("hide")}),$j(document).on("change","#ssoProj",function(e){var o=$(this).val();if(""!=o){var t=o;-1!=t.indexOf("\\")&&(t=t.split("\\")[0]),$("#hdnssoProj").val(t);var n=$("#ssoType").val();if($("#hdnssoType").val(n),void 0!==n&&""!=n)"windows"==n&&($("#dvssoWindows").removeClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"));else try{if(""!=SSOlistcon)JSON.parse(SSOlistcon).hasOwnProperty(t)}catch(s){}}}),$j(document).on("change","#ssoType",function(e){var o=$(this).val(),t=$("#ssoProj").val();""!=o&&""!=t&&(-1!=t.indexOf("\\")&&(t=t.split("\\")[0]),$("#hdnssoProj").val(t),$("#hdnssoType").val(o),$("#dvssoOptionWindow").removeClass("d-none"),"windows"==o?($("#dvssoWindows").removeClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"saml"==o?($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").removeClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"office365"==o?($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").removeClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"okta"==o?($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").removeClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"google"==o?($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").removeClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"facebook"==o?($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").removeClass("d-none"),$("#dvssoOpenId").addClass("d-none"),existtingSSOInfo(t,o)):"openid"==o&&($("#dvssoWindows").addClass("d-none"),$("#dvssoSAML").addClass("d-none"),$("#dvssoOff365").addClass("d-none"),$("#dvssoOkta").addClass("d-none"),$("#dvssoGoogle").addClass("d-none"),$("#dvssoFb").addClass("d-none"),$("#dvssoOpenId").removeClass("d-none"),existtingSSOInfo(t,o)))}),$j(document).on("click","#btnSSOdeleteType",function(e){if(null!=$("#ssoProj").val()&&""!=$("#ssoProj").val()&&null!=$("#ssoType").val()&&""!=$("#ssoType").val())var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[538]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$.ajax({url:"Config.aspx/SSoTypeDelete",type:"POST",cache:!1,async:!0,data:JSON.stringify({ssoProj:$("#ssoProj").val(),ssoType:$("#ssoType").val()}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&"deleted"==e.d?(showAlertDialog("success","SSO Connection deleted successfully"),window.location.href=window.location.href):showAlertDialog("error","Error while deleting SSO Connection, please try later.")},error:function(e){showAlertDialog("error",e)}})}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}});else showAlertDialog("error","Please Select SSO Connection Name and SSO Type.")}),$j(document).on("click","#btnSSOdeleteCon",function(e){if(null!=$("#ssoProj").val()&&""!=$("#ssoProj").val())var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[537]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$.ajax({url:"Config.aspx/SSoConDelete",type:"POST",cache:!1,async:!0,data:JSON.stringify({ssoProj:$("#ssoProj").val()}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&"deleted"==e.d?(showAlertDialog("success","SSO Connection deleted successfully"),window.location.href=window.location.href):showAlertDialog("error","Error while deleting SSO Connection, please try later.")},error:function(e){showAlertDialog("error",e)}})}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}});else showAlertDialog("error","Please Select SSO Connection Name.")});