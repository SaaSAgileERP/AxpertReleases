/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var s,o,r=[],n=!0,i=!1;try{for(a=a.call(e);!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(c){i=!0,o=c}finally{try{n||null==a["return"]||a["return"]()}finally{if(i)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var armToken="",axProcessObj,LoadIframe=callParentNew("LoadIframe"),cardsData={},cardsDesign={},xmlMenuData="",menuJson="",_horizontalFlow=!0,_autoLoadNextTask=!0,dtCulture=eval(callParent("glCulture")),processflowJson={},taskdetailsJson={},TaskCount=0;callParentNew("AxNotifyMsgId=","");var cardsDashboardObj={dirLeft:!0,enableMasonry:!1,homePageType:"cards",isCardsDashboard:!0,isMobile:isMobileDevice()},files={css:[],js:[]},queryString=window.location.search,taskcards="",myDiv=document.getElementById("body_Container"),AxProcessFlow=function(){function AxProcessFlow(){_classCallCheck(this,AxProcessFlow),this._entity={inValid:function(e){return null==e||void 0===e||""==e},metaData:[{fldname:"DropDown",fldcap:"Task Status",fdatatype:"c",cdatatype:"DropDown",hide:"F"},{fldname:"DropDown",fldcap:"Task Type",fdatatype:"c",cdatatype:"DropDown",hide:"F"},{fldname:"DropDown",fldcap:"Message Type",fdatatype:"c",cdatatype:"DropDown",hide:"F"},{fldname:"DropDown",fldcap:"Process Name",fdatatype:"c",cdatatype:"DropDown",hide:"F"},{fldname:"DropDown",fldcap:"User Name",fdatatype:"c",cdatatype:"DropDown",hide:"F"},{fldname:"Date",fldcap:"Date",fdatatype:"d",cdatatype:"Date",hide:"F"},{fldname:"Numeric",fldcap:"Numeric",fdatatype:"n",cdatatype:"Numeric",hide:"F"},{fldname:"Text",fldcap:"Text",fdatatype:"t",cdatatype:"Text",hide:"F"}]},this.tasksJson={},this.filterChanged=!1,this.pageNo=1,this.pageSize=20,this.count=0,this.isFetching=!1,this.lastScrollLeft=0,this.lastScrollTop=0,this.isDropdownClick=!1,this.filterkey="All",this.isInitialized=!1,this.isAxpertFlutter=!this.isNullOrEmpty(armToken),this.cardParams={},this.cardFlds={},this.processName="",this.keyField="",this.keyValue="",this.taskCompleted=!1,this.taskId="",this.userType="GUEST",this.isTaskEditable=!1,this.currentElem=null,this.taskStatus="",this.currentIndex=1,this.stepHtml='\n            <div class="step">\n                <div>\n                    <div class="circle d-none">\n                        <i class="fa fa-check"></i>\n                        <span class="Emp-steps-counts">{{sno}}</span>\n                    </div>\n                    <div class="line"></div>\n                </div>\n                <div class="Task-process-wrapper">\n                    {{groupNameHtml}}\n                    {{taskCaptionHtml}}\n                </div>\n            </div>',this.groupNameHtml='\n            <div class="title">\n                <a href="#">{{taskgroupname}}</a>\n                    <span data-groupname="{{taskgroupname}}" class="Process-flow accordion-icon rotate">\n                    <span  class="material-icons material-icons-style material-icons-2">chevron_right</span>\n                </span>\n            </div>',this.taskCaptionHtml="<div class=\"process-sub-flow\" data-groupname=\"{{taskgroupname}}\">\n            <div class=\"Task-process-list vertical-steps status-{{taskstatus}}\" data-indexno='{{indexno}}' onclick=\"axProcessObj.openTask(this, '{{taskname}}', '{{tasktype}}', '{{transid}}', '{{keyfield}}', '{{keyvalue}}', '{{recordid}}', '{{taskid}}', '{{indexno}}','{{hlink_transid}}','{{hlink_params}}','{{processname}}');\" data-taskid=\"{{taskid}}\" data-tasktype=\"{{tasktype}}\" data-transid=\"{{transid}}\" data-recordid=\"{{recordid}}\">\n                <a href=\"#\">{{taskname}}</a>\n            </div>\n        </div>",this.bulkTaskRowHtml='\n        <div class="table align-middle  fs-6 gy-5 mb-0 dataTable no-footer task-listing-card">\n            \n               \n                        <div class="d-flex flex-column task-name">\n                        <div class="d-flex">\n                            <input type="checkbox" value="" class="form-check-input task-list-checkbox my-auto" data-taskid="{{taskid}}" >\n                            <a href="javascript:void(0)"  class="text-gray-800 fw-bolder fs-6 task-title pt-0 pb-2 px-0" title="{{displaytitle}}"><span href="javascript:void(0)"><span class="material-icons material-icons-style material-icons-1 display-icon task-listing-icons">{{displayicon}}</span>{{displaytitle}}</span></a>\n                            </div><div class="task-subtitle">{{displaycontent}}</div>\n                        </div>\n                  \n\n                        <div class="d-flex flex-row task-process gap-5">\n                            <a href="javascript:void(0)" class="d-flex text-gray-800 task-assignedBy my-auto mb-1 gap-2" title="Assigned By"><span class="material-icons material-icons-style p-0">person</span><span class="p-0"> {{fromuser}}</span></a>\n                            <a href="javascript:void(0)" title="Assigned On" class="d-flex text-gray-800 mb-1 task-date my-auto gap-2"><span class="material-icons material-icons-style p-0">today</span><span class="p-0"> {{eventdatetime}}</span></a>\n                        </div>\n                                      \n           \n        </div>',this.horizontalStepHtml="<li class=\"{{taskstatus}}\">\n                                <a href=\"javascript:void(0)\" onclick=\"axProcessObj.openTask(this, '{{taskname}}', '{{tasktype}}', '{{transid}}', '{{keyfield}}', '{{keyvalue}}', '{{recordid}}', '{{taskid}}', '{{indexno}}','{{hlink_transid}}','{{hlink_params}}','{{processname}}');\" data-taskid=\"{{taskid}}\" data-tasktype=\"{{tasktype}}\" data-transid=\"{{transid}}\" data-recordid=\"{{recordid}}\" data-taskname=\"{{taskname}}\" data-indexno='{{indexno}}' class=\"horizontal-steps {{taskstatus}}\">\n                                    <span class=\"circle\">{{sno}}</span>\n                                    <span class=\"label\">{{taskname}}</span>\n                                </a>\n                            </li>",this.dataSources=[],this.processFlowObj={},this.processProgressObj={},this.getUrlParams(),this.horizontalFlow=_horizontalFlow,this.autoLoadNextTask=_autoLoadNextTask,this.isScrollAtBottomWithinDiv=this.isScrollAtBottomWithinDiv.bind(this),this.fetchProcessList=this.fetchProcessList.bind(this),this.processVars={plistTbIcons:["add_task","receipt_long","post_add","library_books","free_cancellation","published_with_changes"],plistCols:{taskName:{caption:"Task Name",hidden:!1}},pStatus:{approve:{badgeColor:"badge-light-success",bgColor:"bg-light-success",borderColor:"border-light-success",color:"bg-success",iconColor:"text-success"},approved:{badgeColor:"badge-light-success",bgColor:"bg-light-success",borderColor:"border-light-success",color:"bg-success",iconColor:"text-success"},check:{badgeColor:"badge-light-custom-checked",bgColor:"bg-light-custom-checked",borderColor:"border-light-custom-checked",color:"bg-custom-checked",iconColor:"text-custom-checked"},checked:{badgeColor:"badge-light-custom-checked",bgColor:"bg-light-custom-checked",borderColor:"border-light-custom-checked",color:"bg-custom-checked",iconColor:"text-custom-checked"},made:{badgeColor:"badge-light-primary",bgColor:"bg-light-primary",borderColor:"border-light-primary",color:"bg-primary"},make:{badgeColor:"badge-light-primary",bgColor:"bg-light-primary",borderColor:"border-light-primary",color:"bg-primary"},rejected:{badgeColor:"badge-light-danger",bgColor:"bg-light-danger",borderColor:"border-light-danger",color:"bg-danger"},returned:{badgeColor:"badge-light-warning",bgColor:"bg-light-warning",borderColor:"border-light-warning",color:"bg-warning"}}},this.toolbarDrawerHTML='<div class="Tkts-toolbar-Right">\n                            <button id="" type="submit" class="btn btn-sm btn-icon btn-primary btn-active-primary btn-custom-border-radius d-none">\n                                <span class="material-icons material-icons-style material-icons-2">add_task</span>\n                            </button>\n                            <button type="submit" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm" onclick="axProcessObj.taskFilter(\'reset\')" id="reset">\n                                <span class="material-icons material-icons-style material-icons-2">refresh</span>\n                            </button>\n\n\n                            <button type="submit" id="" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm  tb-btn btn-sm">\n                                <span class="material-icons material-icons-style material-icons-2">history_toggle_off</span>\n                            </button>\n                        </div>',this.annHTML='<div class="menu-item px-3">\n            <a class="menu-link px-3 border-bottom" href="javascript:void(0);" data-newtstruct>\n                <span class="symbol symbol-30px symbol-circle me-5">\n                    <span class="symbol-label bg-primary text-white fw-normal fs-3 material-icons"></annIcon></span>\n                </span>\n                <span class="fw-normal addCaption"></annCaption></span>\n            </a>\n        </div>',this.allTskHTML='<div class="custom-menu-item px-3">\n            <span class="custom-menu-link px-3 border-bottom">\n                <span class="form-check form-check-custom form-check-solid me-2">\n                    <input class="form-check-input h-25px w-25px menu-task" type="checkbox" checked="checked"/>\n                </span>\n                <span class="symbol symbol-30px symbol-circle me-2">\n                    <span class="symbol-label bg-light-primary text-primary fw-normal fs-3 material-icons border border-light-primary"></annIcon></span>\n                </span>\n                <span class="fw-normal menu-task-text"></annCaption></span>\n            </span>\n        </div>',this.calledFrom="",this.getProcessUserType()}return _createClass(AxProcessFlow,[{key:"getProcessUserType",value:function(){var e,t=this,a=this;e={processName:this.processName},this.callAPI("../aspx/AxPEG.aspx/AxGetProcessUserType",e,!1,function(e){if(e.success){var s=JSON.parse(e.response);if("Error in ARM connection."==s.d)return void showAlertDialog("error","Error in ARM connection.");a.dataConvert(s,"ARM").every(function(e){var a,s;return"APPROVE"==(null===(a=e.tasktype)||void 0===a?void 0:a.toUpperCase())?(t.userType="APPROVER",!1):"MAKE"!=(null===(s=e.tasktype)||void 0===s?void 0:s.toUpperCase())||(t.userType="MAKER",!1)})}})}},{key:"getNextTaskInProcess",value:function(){var e=this,t=!1;if(!this.autoLoadNextTask)return t;var a,s=this;return"../aspx/AxPEG.aspx/AxGetNextTaskInProcess",a={processName:this.processName,keyValue:this.keyValue},this.callAPI("../aspx/AxPEG.aspx/AxGetNextTaskInProcess",a,!1,function(a){if(a.success){var o=JSON.parse(a.response),r=s.dataConvert(o,"ARM");if(r.length>0){var n=r[0];if(e.horizontalFlow&&"Current Process"!=n.nexttasktype&&(t=!1),"URLSearchParams"in window){t=!0;var i=new URLSearchParams(window.location.search);i.set("keyfield",n.keyfield),i.set("keyvalue",n.keyvalue),i.set("taskid",n.taskid),i.set("target",""),window.location.search=i.toString()}}else callParentNew("LoadIframe(loadhomepage)","function"),t=!0}}),t}},{key:"showProcessTree",value:function(){(this.isNullOrEmpty(axProcessTreeObj)||this.isUndefined(axProcessTreeObj))&&(axProcessTreeObj=new AxProcessTree(this.processName)),axProcessTreeObj.showProcessTree()}},{key:"reloadProcess",value:function(e){this.taskCompleted=!0,ShowDimmer(!0);var t=this,a={processName:this.processName,recordId:e};this.callAPI("../aspx/AxPEG.aspx/AxGetKeyValue",a,!1,function(e){if(e.success){var a=JSON.parse(e.response),s=t.dataConvert(a,"ARM");t.refreshProcess(s[0].keyvalue)}})}},{key:"refreshPage",value:function(){window.location.href=window.location.href}},{key:"refreshProcess",value:function(e){this.refreshPage()}},{key:"hideDefaultCenterPanel",value:function(){document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.remove("d-none")}},{key:"fetchProcessList",value:function(){var e=this,t={pageNo:this.pageNo,pageSize:this.pageSize,filter:this.filterkey.toLocaleLowerCase()};this.callAPI("../aspx/AxPEG.aspx/AxGetAllActiveTasks",t,!0,function(t){if(t.success){var a=JSON.parse(t.response);if("Error in ARM connection."===a.d)return ShowDimmer(!1),void showAlertDialog("error","Error in ARM connection.");var s=e.dataConvert(a,"ARM");e.tasksJson=s.result.tasks||[],e.tasksJson.length>0?e.showProcessList():e.showNoMoreRecords(),ShowDimmer(!1)}else ShowDimmer(!1),showAlertDialog("error","Failed to fetch tasks.")})}},{key:"filterProcessList",value:function(e){e&&(document.querySelector("#advTextSearch").value="");var t=document.querySelector("#advTextSearch").value;if(this.inValid(t))document.querySelectorAll(".filterApplied").forEach(function(e){e.classList.remove("d-none"),e.classList.remove("filterApplied")});else{t=t.toLowerCase();var a=axProcessObj.dataSources.ProcessList.list.filter(function(e){var a;return null===(a=e.displaytitle)||void 0===a?void 0:a.toLowerCase().includes(t)});document.querySelectorAll("#plistAccordion tr").forEach(function(e){e.classList.add("d-none"),e.classList.add("filterApplied")}),a.length>0&&a.forEach(function(e){document.querySelectorAll('.filterApplied [data-taskid="'.concat(e.taskid,'"]')).forEach(function(e){var t,a;null==e||null===(t=e.closest("tr"))||void 0===t||t.classList.remove("d-none"),null==e||null===(a=e.closest("tr"))||void 0===a||a.classList.remove("filterApplied")})})}}},{key:"fetchProcessKeyValues",value:function(e){var t=this,a=this,s={processName:this.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetProcessKeyValues",s,!0,function(e){if(e.success){var s=JSON.parse(e.response),o=a.dataConvert(s,"ARM"),r=[];o.forEach(function(e){r.push({id:e.keyvalue,text:e.keyvalue})}),$("select#keyvalues-select").select2({placeHolder:"Search...",data:r}).on("select2:select",function(e){var t=e.params.data.text;a.refreshProcess(t)}).on("select2:open",function(){$(t).find(".select2-search__field").focus()}).on("select2:close",function(){$(".searchBoxChildContainer.search").addClass("d-none")})}})}},{key:"callAPI",value:function(e,t,a,s){var o=this,r=new XMLHttpRequest;r.open("POST",e,a),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.isAxpertFlutter&&(r.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),r.onreadystatechange=function(){4==this.readyState&&(200==this.status?s({success:!0,response:this.responseText}):(o.catchError(this.responseText),s({success:!1,response:this.responseText})))},r.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(a){this.catchError(a.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(a){this.catchError(a.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e||"null"==e}},{key:"isNullOrEmpty",value:function(e){return null==e||"null"==e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}},{key:"showVerticalProgress",value:function(e){var t,a,s=this,o=this;a={processName:this.processName,keyField:this.keyField,keyValue:this.keyValue};var r=(null==e?void 0:null===(t=e.dataset)||void 0===t?void 0:t.taskid)||this.taskId;this.callAPI("../aspx/AxPEG.aspx/AxGetProcess",a,!0,function(e){if(e.success){o.hideDefaultCenterPanel(),ShowDimmer(!1);var t=JSON.parse(e.response),a=o.dataConvert(t,"ARM");s.processProgressObj={},a.forEach(function(e,t){var a=e.tasktype.toUpperCase();if(-1==["IF","ELSE","ELSE IF","END"].indexOf(a)){if(s.isNullOrEmpty(e.taskstatus)&&e.indexno>1)return void(e.taskstatus="disabled");s.isUndefined(s.processProgressObj[e.taskname])&&(s.processProgressObj[e.taskname]={},s.processProgressObj[e.taskname].group_name_html="",s.processProgressObj[e.taskname].task_caption_html=""),s.isNullOrEmpty(e.recordid)&&(e.recordid="0");var o=s.processProgressObj[e.taskname];o.indexno=e.indexno,o.task_caption_html+=Handlebars.compile(s.taskCaptionHtml)(e)}}),document.querySelector("#procflow-steps").innerHTML="";for(var n,i,c,l=1,d=0,u=Object.entries(s.processProgressObj);d<u.length;d++){var p=_slicedToArray(u[d],2),m=(p[0],p[1]);document.querySelector("#procflow-steps").insertAdjacentHTML("beforeend"," ".concat(s.stepHtml.replace("{{sno}}",l).replace("{{groupNameHtml}}",m.group_name_html).replace("{{taskCaptionHtml}}",m.task_caption_html)," ")),l++}if(ShowDimmer(!1),s.taskCompleted){if(s.taskCompleted=!1,!s.getNextTaskInProcess())if(s.inValid(document.querySelector(".vertical-steps.status-Active"))){if(!s.inValid(document.querySelector(".vertical-steps"))){var h,f,v;s.calledFrom="ProgressBar",null===(h=document.querySelector(".vertical-steps"))||void 0===h||h.click(),null===(f=document.querySelector(".vertical-steps"))||void 0===f||f.scrollIntoView(),r=null===(v=document.querySelector(".vertical-steps").dataset)||void 0===v?void 0:v.taskid}}else s.calledFrom="ProgressBar",null===(n=document.querySelector(".vertical-steps.status-Active"))||void 0===n||n.click(),null===(i=document.querySelector(".vertical-steps.status-Active"))||void 0===i||i.scrollIntoView(),r=null===(c=document.querySelector(".vertical-steps.status-Active").dataset)||void 0===c?void 0:c.taskid}else if(s.inValid(s.taskId)){if(!s.inValid(s.target)){s.calledFrom="ProgressBar";var y,g,k,b='.vertical-steps[data-taskname="'.concat(s.target,'"]');if(s.inValid(document.querySelector(b))){if(!s.inValid(document.querySelector(".vertical-steps"))){var w,S,x;s.calledFrom="ProgressBar",null===(w=document.querySelector(".vertical-steps"))||void 0===w||w.click(),null===(S=document.querySelector(".vertical-steps"))||void 0===S||S.scrollIntoView(),s.inValid(r)&&(r=null===(x=document.querySelector(".vertical-steps").dataset)||void 0===x?void 0:x.taskid)}}else null===(y=document.querySelector(b))||void 0===y||y.click(),null===(g=document.querySelector(b))||void 0===g||g.scrollIntoView(),s.inValid(r)&&(r=null===(k=document.querySelector(b).dataset)||void 0===k?void 0:k.taskid);s.target=null}}else{s.calledFrom="ProgressBar";var T,A,P,D='.vertical-steps[data-taskid="'.concat(s.taskId,'"]');if(!s.inValid(document.querySelector(D)))null===(T=document.querySelector(D))||void 0===T||T.click(),null===(A=document.querySelector(D))||void 0===A||A.scrollIntoView(),s.inValid(r)&&(r=null===(P=document.querySelector(D).dataset)||void 0===P?void 0:P.taskid);s.target=null}o.inValid(r)||o.setActiveInList(r),$(".accordion-icon").click(function(){var e=$(this).attr("data-groupname");$(this).toggleClass("rotate"),$('.process-sub-flow[data-groupname="'.concat(e,'"]')).toggle()})}})}},{key:"showHorizontalProcessFlow",value:function(){var e=this,t=1;document.querySelector("#horizontal-processbar").innerHTML="",this.dataSources.Process.forEach(function(a,s){var o,r=a.tasktype.toUpperCase();-1==["IF","ELSE","ELSE IF","END"].indexOf(r)&&(e.isNullOrEmpty(a.taskstatus)&&a.indexno>1?a.taskstatus="disabled":["APPROVED","REJECTED","RETURNED","CHECKED","MADE"].indexOf(null===(o=a.taskstatus)||void 0===o?void 0:o.toUpperCase())&&(a.taskstatus="completed"),e.taskId==a.taskid&&(a.taskstatus="active"),e.isNullOrEmpty(a.recordid)&&(a.recordid="0"),a.sno=t,t++,document.querySelector("#horizontal-processbar").insertAdjacentHTML("beforeend"," ".concat(Handlebars.compile(e.horizontalStepHtml)(a)," ")))}),ShowDimmer(!1)}},{key:"openTask",value:function(e,t,a,s,o,r,n,i,c,l,d,u,p,m){switch(document.getElementById("horizontal-processbar").innerHTML="",ShowDimmer(!0),this.currentIndex=parseInt(c),this.keyField=o,this.keyValue=r||this.keyValue,this.taskId=i,this.processName=u,this.taskType=a,this.inValid(m)||(this.calledFrom=m),callParentNew("AxNotifyMsgId=",""),this.inValid(p)||"message"!=p.toLowerCase()&&"form notification"!=p.toLowerCase()&&"periodic notification"!=p.toLowerCase()||(a=p),a.toUpperCase()){case"MAKE":document.querySelector("#pd_timeline").classList.remove("d-none"),this.showProgressNew(),this.openTstruct(t,s,o,r,n);break;case"CHECK":case"APPROVE":document.querySelector("#pd_timeline").classList.remove("d-none"),this.showProgressNew(),this.openProcessTask(t,a,i);break;case"FORM NOTIFICATION":case"PERIODIC NOTIFICATION":case"MESSAGE":document.querySelector("#pd_timeline").classList.add("d-none"),this.openMessageLink(l,d);break;case"CACHED SAVE":document.querySelector("#pd_timeline").classList.add("d-none"),this.openMessageLinkCachedSave(l,d,i);break;case"EXPORT":this.DownloadExportFile(d)}}},{key:"DownloadExportFile",value:function(e){if(""!=e&&(e.startsWith("http:")||e.startsWith("https:"))){var t=e,a=e.substring(e.lastIndexOf("/")+1),s=a.lastIndexOf("_"),o=a.substring(0,s)+a.substring(a.lastIndexOf(".")),r=document.createElement("a");r.href=t,r.download=o,document.body.appendChild(r),r.click(),setTimeout(function(){setTimeout(function(){document.body.removeChild(r)},0)},500),ShowDimmer(!1)}else{var n=e.substring(0,e.lastIndexOf("\\")+1),i=e.substring(e.lastIndexOf("\\")+1);$.ajax({type:"POST",url:"../WebService.asmx/LoadExportFileToScript",cache:!1,async:!1,contentType:"application/json;charset=utf-8",data:JSON.stringify({filePath:n,fileName:i}),dataType:"json",success:function(e){if(e.d&&""!=e.d){var t=e.d,a=e.d.substring(e.d.lastIndexOf("/")+1),s=document.createElement("a");s.href=t,s.download=a,document.body.appendChild(s),s.click(),setTimeout(function(){setTimeout(function(){document.body.removeChild(s)},0)},500),ShowDimmer(!1)}else ShowDimmer(!1)},error:function(e){ShowDimmer(!1)},failure:function(e){ShowDimmer(!1)}})}}},{key:"setActiveInList",value:function(e){document.querySelectorAll('[data-taskid="'.concat(e,'"]')).forEach(function(e){var t,a,s;e.classList.contains("Procurement-list")&&(null===(t=document.querySelector(".Procurement-list-wrap.active"))||void 0===t||t.classList.remove("active"),null===(a=e.closest(".Procurement-list-wrap"))||void 0===a||a.classList.add("active"));e.classList.contains("horizontal-steps")&&(document.querySelectorAll(".horizontal-steps").forEach(function(e){var t;null===(t=e.closest("li"))||void 0===t||t.classList.remove("Active")}),null===(s=e.closest("li"))||void 0===s||s.classList.add("Active"))})}},{key:"openRightSideCards",value:function(e,t){ShowDimmer(!0),files.js.push("/../ThirdParty/lodash.min.js?v=1"),files.js.push("/../ThirdParty/deepdash.min.js"),files.js.push("/../Js/handlebars.min.js?v=2"),files.js.push("/../Js/handleBarsHelpers.min.js"),files.js.push("/../ThirdParty/Highcharts/highcharts-3d.js"),files.js.push("/../ThirdParty/Highcharts/highcharts-more.js"),files.js.push("/../ThirdParty/Highcharts/highcharts.js"),files.js.push("/../ThirdParty/Highcharts/highcharts-exporting.js"),files.js.push("/../Js/high-charts-functions.min.js?v=20"),files.js.push("/../Js/AxInterface.min.js?v=13"),files.js.push("/../ThirdParty/DataTables-1.10.13/media/js/jquery.dataTables.js"),files.js.push("/../ThirdParty/DataTables-1.10.13/media/js/dataTables.bootstrap.js"),files.js.push("/../ThirdParty/DataTables-1.10.13/extensions/Extras/moment.min.js"),files.css.push("/../ThirdParty/fullcalendar/lib/main.min.css"),files.js.push("/../ThirdParty/fullcalendar/lib/main.min.js"),cardsDashboardObj.isMobile&&files.js.push("/../ThirdParty/jquery-ui-touch-punch-master/jquery.ui.touch-punch.min.js"),cardsDashboardObj.enableMasonry&&files.js.push("/../ThirdParty/masonry/masonry.pkgd.min.js"),document.getElementsByTagName("body")[0].classList.contains("btextDir-rtl")&&(cardsDashboardObj.dirLeft=!1),loadAndCall({files:files,callBack:function(){$(function(){$.ajax({url:"../aspx/AxPEG.aspx/AxGetCardsData",type:"POST",cache:!1,async:!0,data:JSON.stringify({processName:axProcessObj.processName||"",taskName:e||"",keyValue:t||""}),dataType:"json",contentType:"application/json",success:function(e){if(e.d&&""!=e.d){var t,a,s=JSON.parse(e.d);if(null==s||null===(t=s.result)||void 0===t||!t.success)return document.querySelector("#PROFLOW_Right_Last").classList.add("d-none"),(a=document.querySelector("#PROFLOW_Right").classList).add("col-md-9","col-xl-9"),void a.remove("col-md-7","col-xl-7");if(document.querySelector("#PROFLOW_Right_Last").classList.remove("d-none"),(a=document.querySelector("#PROFLOW_Right").classList).remove("col-md-9","col-xl-9"),a.add("col-md-7","col-xl-7"),cardsData.value=JSON.stringify(s.result.cards),cardsDesign.value="",""!=xmlMenuData){xmlMenuData=xmlMenuData.replace(/&apos;/g,"'");var o=parseXml(xmlMenuData),r=xml2json(o,"");menuJson=JSON.parse(r)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:menuJson}),appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==cardsData.value?ReverseCheckSpecialChars(cardsData.value):"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),design:(JSON.parse(""!==cardsDesign.value?cardsDesign.value:"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),enableMasonry:cardsDashboardObj.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:".cardsPlot",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var n=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:cardsDashboardObj.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:cardsDashboardObj.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=n.cardsPage,ShowDimmer(!1)}else showAlertDialog("error","Error while loading cards dashboard..!!")},error:function(e){ShowDimmer(!1),showAlertDialog("error","Error while loading cards dashboard..!!")},failure:function(e){ShowDimmer(!1),showAlertDialog("error","Error while loading cards dashboard..!!")}})})}})}},{key:"isEditableTask",value:function(e,t){var a=!1,s=this,o={processName:this.processName,taskName:e,keyValue:t,indexNo:this.currentIndex};return this.callAPI("../aspx/AxPEG.aspx/AxGetEditableTask",o,!1,function(e){if(e.success){var t=JSON.parse(e.response),o=s.dataConvert(t,"ARM");if((null==o?void 0:o.length)>0){var r=o[0];"T"==(null==r?void 0:r.editable)&&(a=!0)}}}),a}},{key:"openTstruct",value:function(e,t,a,s,o){var r;ShowDimmer(!0);var n="APPROVER"==this.userType?"&fromprocess=true":"",i="";if(!this.inValid(this.keyValue)&&"NA"!=this.keyValue&&(null==document.querySelector('[data-tasktype="Make"][data-transid="'.concat(t,'"][data-recordid="0"]'))||null!==(r=this.currentElem)&&void 0!==r&&r.classList.contains("completed"))){var c=this.isEditableTask(e,this.keyValue);i="&ispegedit=".concat(c.toString()),this.isTaskEditable=!1!==c}var l="../aspx/tstruct.aspx?transid=".concat(t).concat(n).concat(i);this.isNullOrEmpty(o)&&(o="0"),l+="0"!=o?"&act=load&recordid=".concat(o):""!=s&&"{{keyvalue}}"!=s?"&act=open&".concat(a,"=").concat(s):"&act=open&".concat(this.keyField,"=").concat(this.keyValue),document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.remove("d-none");var d=document.querySelector("#rightIframe");d.classList.remove("d-none"),d.setAttribute("src",""),d.setAttribute("src",l)}},{key:"openMessageLink",value:function(e,t){if(ShowDimmer(!0),""==e)return showAlertDialog("error","Page name should not be empty."),!1;var a="";t=t.replace("^","&"),e.startsWith("i")?(e=e.substring(1),a="../aspx/iview.aspx?ivname=".concat(e,"&").concat(t)):e.startsWith("t")?(e=e.substring(1),a="../aspx/tstruct.aspx?transid=".concat(e,"&").concat(t)):e.startsWith("c")&&(a="../aspx/".concat(t)),document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.add("d-none");var s=document.querySelector("#rightIframe");s.classList.remove("d-none"),s.setAttribute("src",""),s.setAttribute("src",a),e.startsWith("c")&&ShowDimmer(!1)}},{key:"openMessageLinkCachedSave",value:function(e,t,a){if(ShowDimmer(!0),""==e)return showAlertDialog("error","Page name should not be empty."),!1;var s="";t=t.replace("^","&"),e.startsWith("i")?(e=e.substring(1),s="../aspx/iview.aspx?ivname=".concat(e,"&").concat(t)):e.startsWith("t")?(e=e.substring(1),callParentNew("AxNotifyMsgId=",a),s="../aspx/tstruct.aspx?transid=".concat(e,"&").concat(t)):e.startsWith("c")&&(s="../aspx/".concat(t)),document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.add("d-none");var o=document.querySelector("#rightIframe");o.classList.remove("d-none"),o.setAttribute("src",""),o.setAttribute("src",s),e.startsWith("c")&&ShowDimmer(!1)}},{key:"newTstruct",value:function(e,t){ShowDimmer(!0),document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.remove("d-none");var a="APPROVER"==this.userType?"fromprocess=true&":"",s="../aspx/tstruct.aspx?".concat(a,"transid=").concat(e,"&act=open"),o=document.querySelector("#rightIframe");o.classList.remove("d-none"),o.setAttribute("src",""),o.setAttribute("src",s),this.keyValue="NA",this.horizontalFlow?this.showProgress():this.showVerticalProgress(),axProcessObj.openRightSideCards(t,"NA"),ShowDimmer(!1)}},{key:"openBulkApprove",value:function(){try{var e;"../aspx/AxPEG.aspx/AxGetBulkApprovalCount",e={},this.callAPI("../aspx/AxPEG.aspx/AxGetBulkApprovalCount",e,!0,function(e){if(e.success){var t=JSON.parse(e.response);if((t=JSON.parse(t.d)).result.data.length>0){var a="";(t=t.result.data).forEach(function(e){a+='<div class="d-flex custom-menu-item px-4 py-2 border-1 border-bottom">\n<div class="symbol symbol-45px">\n                        <span class="symbol-label">\n                            <img alt="{{processname}}" class=" w-30px" src="../images/homepageicon/{{processname}}.png"\n                                onerror="this.onerror=null;this.src=\'../images/homepageicon/default.png\';">\n\n                        </span></div>\n            <div class="d-flex align-items-center " onclick="axProcessObj.openBulkApprovePopup(\''.concat(e.processname,'\')">\n                        <span class="custom-menu-link px-3">\n                            <span class="fw-normal fs-5 menu-task-text">').concat(e.processname," (").concat(e.pendingapprovals,")</span>\n                        </span></div>\n                        </div>")}),document.getElementsByTagName("pd-allTasksNew")&&document.getElementsByTagName("pd-allTasksNew").length>0&&(document.getElementsByTagName("pd-allTasksNew")[0].outerHTML=a)}else{showAlertDialog("warning","No records available for approvals.");var s=document.querySelector('[data-kt-menu="true"][data-id="pd_all_tasksNew"]');s&&s.classList.remove("show")}}})}catch(t){showAlertDialog("error",t.message)}}},{key:"openBulkApprovePopup",value:function(e){var t=this;document.querySelector("body").click(),this.processName=e;var a={id:"ldbApprove",iFrameModalBody:'\n            <div class="card-body d-flex  row">\n                <div class="w-100" id="Bulk-SelectALL-wrap">\n                    <div class="form-check" style="position:absolute">\n                      <input class="form-check-input task-list-checkbox" type="checkbox" id="select-all-checkbox">\n                      <label class="form-check-label" for="select-all-checkbox">\n                        Select All\n                      </label>\n                    </div>\n                    <h4 style="margin-left: 295px; font-weight:bold">Bulk Approvals</h4>\n                </div>\n                <div class="w-100" id="BulkActiveList_Container">\n                </div>\n                <div class="w-100 mt-3">\n                    <div class="approval-controls" data-tasktype="Approve">\n                        <label class="form-label col-form-label mandatory">Bulk Approval Comments</label>\n                        <div class="input-group">\n                            <textarea data-tasktype="Approve" class="form-control"\n                                data-tasktype="Approve" id="BULKAPPROVEComments"></textarea>\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <button  style="float:right " class="btn btn-primary btn-sm mt-2" type="button" onclick="axProcessObj.doBulkAction(\'BULKAPPROVE\',\'APPROVE\');">Bulk Approve</button>\n                </div>\n            </div>',size:"lg"};a.opening=t.bulkInit;try{var s=new BSModal("modal_".concat(a.id),"",a.iFrameModalBody,function(e){t.bulkInit(),ShowDimmer(!1)},function(e){});s.changeSize(a.size||"fullscreen"),s.hideHeader(),s.hideFooter(),s.showFloatingClose()}catch(o){showAlertDialog("error",o.message)}}},{key:"fetchBulkTasks",value:function(e){var t=this,a=this,s={processName:a.processName,taskType:"Approve"};this.callAPI("../aspx/AxPEG.aspx/AxGetBulkActiveTasks",s,!0,function(s){if(s.success){var o=JSON.parse(s.response),r=a.dataConvert(o,"ARM");a.dataSources[e]=r,t.showBulkTasks(),ShowDimmer(!1)}else ShowDimmer(!1)})}},{key:"bulkInit",value:function(){this.fetchBulkTasks("BulkTasks");var e=document.getElementById("select-all-checkbox");null==e||e.addEventListener("change",function(){document.querySelectorAll(".task-list-checkbox").forEach(function(t){t.checked=e.checked})})}},{key:"showBulkTasks",value:function(){var e,t=this;document.querySelector("#BulkActiveList_Container").innerHTML="",(null===(e=this.dataSources.BulkTasks)||void 0===e?void 0:e.length)==undefined||0==this.dataSources.BulkTasks.length?this.isUndefined(parent.axProcessObj)?document.querySelector("#BulkActiveList_Container").insertAdjacentHTML("beforeend"," ".concat(this.noRecordsRowHtml," ")):document.querySelector("#BulkActiveList_Container").insertAdjacentHTML("beforeend"," ".concat(this.processedRowHtml," ")):this.dataSources.BulkTasks.forEach(function(e,a){var s=Handlebars.compile(t.bulkTaskRowHtml)(e);document.querySelector("#BulkActiveList_Container").insertAdjacentHTML("beforeend"," ".concat(s," "))})}},{key:"doBulkAction",value:function(e,t){var a=this;ShowDimmer(!0);var s=document.querySelector("#".concat(e,"Comments")).value,o=document.querySelectorAll(".task-list-checkbox:checked");if(0==o.length)return showAlertDialog("Error","Select atleast one task for approval."),ShowDimmer(!1),!1;if(""==s)return showAlertDialog("Error","Bulk Approval Comments cannot be left empty."),ShowDimmer(!1),!1;var r=[];o.forEach(function(e){r.push(e.dataset.taskid)});var n={action:e,taskId:r=r.join(","),taskType:t,statusText:s,processName:this.processName};this.callAPI("../aspx/AxPEG.aspx/AxDoBulkAction",n,!0,function(e){if(ShowDimmer(!1),e.success){var t=JSON.parse(e.response);a.isAxpertFlutter||(t=JSON.parse(t.d)),t.result.success?(a.showSuccess(t.result.message),a.isUndefined(parent.axProcessObj)?setTimeout(function(){axProcessObj.refreshPage()},1e3):parent.window.location.reload()):a.catchError(t.result.message)}})}},{key:"getUrlParams",value:function(){var e=window.location.search,t=new URLSearchParams(e);this.keyField=t.get("keyfield"),this.keyValue=t.get("keyvalue")||"NA",this.processName=t.get("processname")||_processName,this.taskId=t.get("taskid")||"",this.transId=t.get("transid")||"",this.target=t.get("target")||"",this.add=t.get("add")||"T",this.leftPanel=t.get("left")||"T",this.rightPanel=t.get("right")||"T",this.showTree=t.get("tree")||"T",this.bulkApproval=t.get("bulk")||"T",this.horizontal=t.get("horizontal")||"T",_autoLoadNextTask="F"!=t.get("autoloadnexttask")&&_autoLoadNextTask}},{key:"openProcessTask",value:function(e,t,a){ShowDimmer(!0);var s="../aspx/processflow.aspx?loadcaption=Active Lists&processname=".concat(this.processName,"&keyfield=").concat(this.keyField,"&keyvalue=").concat(this.keyValue,"&taskname=").concat(e,"&tasktype=").concat(t,"&taskid=").concat(a);document.querySelector("#process_centerpanel").classList.add("d-none"),document.querySelector("#horizontal-processbar").classList.remove("d-none");var o=document.querySelector("#rightIframe");o.classList.remove("d-none"),o.setAttribute("src",""),o.setAttribute("src",s)}},{key:"openSearch",value:function(){$(".searchBoxChildContainer.search").hasClass("d-none")?($(".searchBoxChildContainer.search").removeClass("d-none"),$("select#keyvalues-select").select2("open")):($(".searchBoxChildContainer.search").addClass("d-none"),$("select#keyvalues-select").select2("close"))}},{key:"init",value:function(){try{var e,t;ShowDimmer(!0);var a,s,o,r,n=document.createElement("div");if((e=n.classList).add.apply(e,_toConsumableArray("d-flex gap-4".split(" "))),n.innerHTML=this.toolbarDrawerHTML,"APPROVER"==this.userType&&(null===(t=document.querySelector("#kt_drawer_bulkApprove_button"))||void 0===t||t.classList.remove("d-none")),KTMenu.init(),("F"==this.horizontal||void 0!==_horizontalFlow&&!_horizontalFlow)&&(this.horizontalFlow=!1),"F"==this.add&&document.querySelector("#pd_ann").classList.add("d-none"),"F"==this.leftPanel)document.querySelector("#PROFLOW_Left").classList.add("d-none"),null===(a=document.querySelector("#PROFLOW_Right"))||void 0===a||a.classList.add("right-only");if(this.horizontalFlow)"F"!=this.leftPanel&&this.fetchProcessList("ProcessList");else document.querySelector("#PROFLOW_Left").classList.remove("d-none"),document.querySelector("#PROFLOW_Left .card-header").classList.add("d-none"),document.querySelector("#PROFLOW_Left #PROFLOW-profile-container").classList.remove("d-none"),document.querySelector("#PROFLOW_Left #plistAccordion").classList.add("d-none"),null===(s=document.querySelector("#PROFLOW_Right"))||void 0===s||s.classList.remove("right-only"),this.showVerticalProgress();if("F"==this.rightPanel){var i;null===(i=document.querySelector("#PROFLOW_Right_Last"))||void 0===i||i.classList.add("d-none");var c=document.querySelector("#PROFLOW_Right").classList;c.remove("col-md-7","col-xl-7"),c.add("col-md-9","col-xl-9")}if("F"==this.bulkApproval)null===(o=document.querySelector("#kt_drawer_bulkApprove_button"))||void 0===o||o.classList.add("d-none");if("F"==this.showTree)null===(r=document.querySelector("#proFlw_Tree_button"))||void 0===r||r.classList.add("d-none");document.querySelector("#pd_all_tasksNew").addEventListener("click",function(){document.getElementsByTagName("pd-allTasksNew")&&document.getElementsByTagName("pd-allTasksNew").length>0&&axProcessObj.openBulkApprove()}),document.querySelectorAll("#pd_timeline").forEach(function(e){KTMenu.getInstance(e).on("kt.menu.dropdown.show",function(e){axProcessObj.showTimeLine()})}),myDiv.addEventListener("scroll",this.scrollListener),this.toggleList(),this.toggleCheckbox()}catch(l){this.catchError(l.message)}}},{key:"processNewNode",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==undefined&&arguments[0],a="";if(axProcessObj.dataSources.ProcessList.addnewnode&&axProcessObj.dataSources.ProcessList.addnewnode.length>0)a=Object.values(axProcessObj.dataSources.ProcessList.addnewnode).map(function(t){var a=axProcessObj.annHTML;return!e.isUndefined(t.transid)&&(a=a.replace("data-newtstruct","onclick=\"axProcessObj.newTstruct('".concat(t.transid,"','").concat(t.taskname,"')\""))),a=(a=a.replace("</annIcon>",t.taskicon)).replace("</annCaption>",t.taskname||"")}).join("");else{var s=axProcessObj.annHTML;a=s=(s=s.replace("</annIcon>","playlist_remove")).replace("</annCaption>","No data")}if(t)return a;this.isUndefined(document.getElementsByTagName("anncontent")[0])||(document.getElementsByTagName("anncontent")[0].outerHTML=a)}},{key:"formatEventDate",value:function(e){var t=new Date(e.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$2/$1/$3")),a=new Date,s=new Date(a.getFullYear(),a.getMonth(),a.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=Math.floor((s-o)/864e5),n=new Date(s);n.setDate(s.getDate()-s.getDay());var i=new Date(n);i.setDate(n.getDate()-7);var c=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l=t.toLocaleDateString("en-US",{weekday:"short"}),d=t.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),u="".concat(t.getMonth(),"-").concat(t.getFullYear()),p="".concat(a.getMonth(),"-").concat(a.getFullYear());return 0===r?c:1===r?"".concat(l," ").concat(c):o>=n&&r<=7?"".concat(l," ").concat(c):o>=i&&o<n?"".concat(l," ").concat(c):u===p?"".concat(t.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})):t.getMonth()===(a.getMonth()-1+12)%12&&t.getFullYear()===(0===a.getMonth()?a.getFullYear()-1:a.getFullYear())?"".concat(t.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})):d}},{key:"getTimeframe",value:function(e){var t=new Date,a=_slicedToArray(e.split("/"),3),s=a[0],o=a[1],r=a[2],n=new Date(r,o-1,s);t.setHours(0,0,0,0),n.setHours(0,0,0,0);var i=(t.getTime()-n.getTime())/864e5;if(0===i)return"Today";if(1===i)return"Yesterday";var c=t.getDay(),l=new Date(t);l.setDate(t.getDate()-c);var d=new Date(l);d.setDate(d.getDate()-7);var u=new Date(d);if(u.setDate(u.getDate()+6),n>=l)return"This Week";if(n>=d&&n<=u)return"Last Week";var p=t.getMonth(),m=t.getFullYear(),h=new Date(m,p,1),f=new Date(m,p-1,1),v=new Date(m,p,0);return n>=h?"This Month":n>=f&&n<=v?"Last Month":"Previous records"}},{key:"scrollListener",value:function(e){var t=this,a=e.target,s=a.scrollTop,o=a.scrollLeft;this.lastScrollTop!==s&&(this.lastScrollTop=s,!this.isFetching&&axProcessObj.isScrollAtBottomWithinDiv(a)&&(this.isFetching=!0,axProcessObj.pageNo++,axProcessObj.fetchProcessList("task","scroll"),setTimeout(function(){t.isFetching=!1},500))),this.lastScrollLeft=o}},{key:"isScrollAtBottomWithinDiv",value:function(e){return e.scrollHeight-(e.scrollTop+e.clientHeight)<=1}},{key:"showProcessList",value:function(){var e=this,t=axProcessObj.tasksJson;try{if(t.length>0){var a=axProcessObj.tasksJson.reduce(function(e,t){var a=axProcessObj.getTimeframe(t.eventdatetime.split(" ")[0]);return e[a]||(e[a]=[]),e[a].push(t),e},{});if(this.isDropdownClick)document.getElementById("plistContent").innerHTML="";Object.keys(a).forEach(function(t){var s=document.getElementById("section-".concat(t.replace(/\s+/g,"")));s?s.querySelector(".accordion-body").insertAdjacentHTML("beforeend",a[t].map(function(t){return e.generateTaskHTML(t)}).join("")):e.createAccordionForTimeframe(t,a[t],s)}),document.querySelectorAll(".tasktitle","#nextrecord","#previousrecord").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".tasktitle").forEach(function(e){e.classList.remove("taskRowClicked")}),this.classList.add("taskRowClicked")})}),this.isInitialized||(document.getElementById("nextrecord").addEventListener("click",function(){e.navigateToRecord("next")}),document.getElementById("previousrecord").addEventListener("click",function(){e.navigateToRecord("previous")}),document.querySelectorAll("#alllist, #activelist, #completedlist").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll("#alllist, #activelist, #completedlist").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),axProcessObj.isDropdownClick=!0,axProcessObj.filterkey=this.getAttribute("data-id"),axProcessObj.pageNo=1,axProcessObj.fetchProcessList()})}),document.querySelector('.selectbtn[data-kt-menu-attach="parent"]').addEventListener("click",function(e){e.preventDefault();var t=e.currentTarget;t.classList.toggle("toggleclicked");var a=document.querySelector(".maincheckbox");document.querySelectorAll(".task-checkbox");document.querySelectorAll(".checkbox-wrapper").forEach(function(e){var s=e.querySelector(".user"),o=e.querySelector(".task-checkbox");o.classList.toggle("toggleclicked"),t.classList.contains("toggleclicked")?(s.style.display="none",o.style.visibility="visible",a.style.display="block"):(s.style.display="flex",o.style.visibility="hidden",a.style.display="none")})}),document.addEventListener("keydown",function(e){"ArrowDown"===e.key?axProcessObj.navigateToRecordWithKeyboard("next"):"ArrowUp"===e.key&&axProcessObj.navigateToRecordWithKeyboard("previous")}),document.querySelectorAll(".listrow").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".listrow").forEach(function(e){e.style.outline="none"})})}),document.querySelector(".accordion-button").addEventListener("click",function(e){if(e.target.classList.contains("collapsed")){var t=document.getElementById("body_Container"),a=document.getElementById("plistContent");if(t&&a){var s=t.offsetHeight,o=a.offsetHeight,r=a.children[a.children.length-1];s>o&&r&&!r.classList.contains("no-more-records")&&(a.style.height="".concat(s,"px"),t.style.overflowY="auto")}}}),this.initializeTooltips(),this.initializeDatePickers(),this.setupSelectAllTasks(),this.isInitialized=!0)}else document.querySelector("#PROFLOW_Left").classList.add("d-none"),document.querySelector("#PROFLOW_Right").classList.add("right-only");this.inValid(this.taskId)||this.taskCompleted||this.setActiveInList(this.taskId)}catch(s){this.catchError(s.message)}this.isDropdownClick=!1}},{key:"openFilters",value:function(){$("#filterModal").modal("show"),document.getElementById("filterGroupName").disabled=!0,""===$("#dvModalFilter").html()&&axProcessObj.createFilterLayout()}},{key:"createFilterLayout",value:function createFilterLayout(){$("#dvModalFilter").html(""),$.each(axProcessObj._entity.metaData,function(e,t){if("T"===t.hide)return!0;axProcessObj.generateFilterHTML(t),axProcessObj._entity.filterObj[t.fldname]&&axProcessObj.updateFilterLayout(t.fldname,axProcessObj._entity.filterObj[t.fldname])}),document.querySelectorAll("#dvModalFilter .filter-fld[data-type=DropDown]").forEach(function(e){var t=e.id,a=_toConsumableArray(new Set(axProcessObj._entity.fldData[t]));$(e).append($("<option></option>").val("0").html("--Select--")),a.forEach(function(t){axProcessObj._entity.inValid(t)||e.insertAdjacentHTML("beforeend",'<option value="'.concat(t,'">').concat(t,"</option>"))}),$(e).select2({multiple:!0}).on("select2:unselect select2:select",function(e){$(this).attr("id");var t=$(this).val();t=t.filter(function(e){return"0"!==e}),$(this).val(t),$(this).trigger("change")})});var glCulture=eval(callParent("glCulture")),dtFormat="d/m/Y";"en-us"==glCulture&&(dtFormat="m/d/Y"),$(".flatpickr-input").flatpickr({dateFormat:dtFormat})}},{key:"convertDateFormat",value:function(e){var t=e.split("/");return"".concat(t[2],"-").concat(t[1],"-").concat(t[0])}},{key:"filterModelClose",value:function(){$("#filterGroupName").val(""),$("#filterGroupModalWrapper").modal("hide"),document.getElementById("filterGroupCheckbox").checked=!1,document.getElementById("filterGroupName").disabled=!0,$("#dvModalFilter").html(""),$("#filterModal").modal("hide")}},{key:"generateFilterHTML",value:function(e){var t=axProcessObj.getFieldDataType(e),a=e.fldcap||"",s=e.fldname,o="";if("BUTTON"!=t.toUpperCase()&&"ATTACHMENTS"!=t.toUpperCase()){switch("n"==e.fdatatype&&(t="Numeric"),t){case"DropDown":o='<div class="row" data-type="'.concat(t,'"><div class="col-md-3 fldCaption"><p class="form-group ">').concat(a,'</p> </div>\n                              <div class="col-md-9 fldCaption">\n                                <select class="form-control filter-fld"  data-type="').concat(t,'" id="').concat(s,'" name="').concat(t,'">\n                                <option value="All">All</option>\n                                </select>\n                              </div>');break;case"Numeric":o='<div class="row filter-fld" data-type="'.concat(t,'" id="').concat(s,'" data-type="').concat(t,'">\n                <div class="col-md-3 fldCaption">\n                <p class="form-group ">').concat(a,'</p>\n                </div> \n                <div class="col-md-9">\n                <div class="form-group form-row fldCaption">\n                <div class="col-md-6 col">\n                <label>From</label>           \n                <input type="number" id="').concat(s,'_from" class="form-control" data-type="').concat(t,'"/>\n                </div>\n                <div class="col-md-6 col">\n                <label>To</label>           \n                <input type="number" id="').concat(s,'_to" class="form-control" data-type="').concat(t,'"/>\n                </div></div></div>');break;case"Date":var r=["Custom","Today","Yesterday","Tomorrow","This week","Last week","Next week","This month","Last month","Next month","This quarter","Last quarter","Next quarter","This year","Last year","Next year"],n=["customOption","todayOption","yesterdayOption","tomorrowOption","this_weekOption","last_weekOption","next_weekOption","this_monthOption","last_monthOption","next_monthOption","this_quarterOption","last_quarterOption","next_quarterOption","this_yearOption","last_yearOption","next_yearOption"];o+='<div class="row filter-fld" data-type="'.concat(t,'" id="').concat(s,'"><div class="col-md-3 fldCaption"><p class="form-group ">').concat(a,'</p></div>\n                                <div class="col-md-4 fldCaption">\n                                <select class="form-select dateFilter" type="text" id="').concat(s,'_dateoption" name="').concat(s,'" data-field="').concat(s,'" onchange="axProcessObj.generateAdvFilterDates(\'').concat(s,"');\">");for(var i=0;i<r.length;i++)o+="<option value=".concat(n[i],">").concat(r[i],"</option>");o+='</select> \n                                </div>\n                                <div class="col-md-5">\n    <div class="form-group form-row fldCaption">\n    <div class="col-md-6 col">\n    <label>From</label>           \n     <input id="'.concat(s,'_from" name="').concat(s,'_from" value="" maxlength="10" type="date" class="form-control flatpickr-input" data-input="" onchange="axProcessObj.validateDateRange(\'').concat(s,'\');">\n    </div>\n    <div class="col-md-6 col">\n    <label>To</label>           \n    <input id="').concat(s,'_to" name="').concat(s,'_to" value="" maxlength="10" type="date" class="form-control flatpickr-input" data-input="" onchange="axProcessObj.validateDateRange(\'').concat(s,"');\">\n    </div></div></div>   \n                                </div>");break;default:o='<div class="row" data-type="'.concat(t,'">\n                <div class="col-md-3 fldCaption">\n                <p class="form-group ">').concat(a,'</p> \n                </div>\n                <div class="col-md-4 fldValue"> \n                <select class="form-select" type="text" id="').concat(s,'_searchoption" class="form-control">\n                <option value="STARTSWITH">Starts with</option>\n                <option value="CONTAINS">Contains</option>\n                <option value="ENDSWITH">Ends with</option>\n                </select></div>\n                <div class="col-md-5 fldValue"> <input type="text" id="').concat(s,'" class="form-control filter-fld" data-type="').concat(t,'"/></div>\n                </div>')}$("#dvModalFilter").append(o)}}},{key:"getDatesBasedonSelection",value:function(e){var t={from:"",to:""},a="en-us"==dtCulture?"MM/DD/YYYY":"DD/MM/YYYY";switch(e){case"customOption":break;case"todayOption":var s=new Date;t.from=t.to=moment(s).format(a);break;case"yesterdayOption":(s=new Date).setDate(s.getDate()-1),t.from=t.to=moment(s).format(a);break;case"tomorrowOption":(s=new Date).setDate(s.getDate()+1),t.from=t.to=moment(s).format(a);break;case"this_weekOption":s=getFirstDayOfWeek(new Date);t.from=moment(s).format(a),s.setDate(s.getDate()+6),t.to=moment(s).format(a);break;case"last_weekOption":(s=getFirstDayOfWeek(new Date)).setDate(s.getDate()-7),t.from=moment(s).format(a),s.setDate(s.getDate()+6),t.to=moment(s).format(a);break;case"next_weekOption":(s=getFirstDayOfWeek(new Date)).setDate(s.getDate()+7),t.from=moment(s).format(a),s.setDate(s.getDate()+6),t.to=moment(s).format(a);break;case"this_monthOption":(s=getFirstDayOfWeek(new Date)).setDate(1),t.from=moment(s).format(a),s.setMonth(s.getMonth()+1),s.setDate(0),t.to=moment(s).format(a);break;case"last_monthOption":(s=getFirstDayOfWeek(new Date)).setDate(1),s.setMonth(s.getMonth()-1),t.from=moment(s).format(a),s.setMonth(s.getMonth()+1),s.setDate(0),t.to=moment(s).format(a);break;case"next_monthOption":(s=getFirstDayOfWeek(new Date)).setDate(1),s.setMonth(s.getMonth()+1),t.from=moment(s).format(a),s.setMonth(s.getMonth()+1),s.setDate(0),t.to=moment(s).format(a);break;case"this_quarterOption":s=new Date;var o=Math.floor((s.getMonth()+3)/3);s.setDate(1),s.setMonth(3*o-3),t.from=moment(s).format(a),s.setMonth(s.getMonth()+3),s.setDate(0),t.to=moment(s).format(a);break;case"last_quarterOption":s=new Date;0==(o=Math.floor((s.getMonth()+3)/3)-1)&&(o=4,s.setFullYear(s.getFullYear()-1)),s.setDate(1),s.setMonth(3*o-3),t.from=moment(s).format(a),s.setMonth(s.getMonth()+3),s.setDate(0),t.to=moment(s).format(a);break;case"next_quarterOption":s=new Date;5==(o=Math.floor((s.getMonth()+3)/3)+1)&&(o=1,s.setFullYear(s.getFullYear()+1)),s.setDate(1),s.setMonth(3*o-3),t.from=moment(s).format(a),s.setMonth(s.getMonth()+3),s.setDate(0),t.to=moment(s).format(a);break;case"this_yearOption":(s=new Date).setDate(1),s.setMonth(0),t.from=moment(s).format(a),s.setFullYear(s.getFullYear()+1),s.setMonth(0),s.setDate(0),t.to=moment(s).format(a);break;case"last_yearOption":(s=new Date).setFullYear(s.getFullYear()-1),s.setDate(1),s.setMonth(0),t.from=moment(s).format(a),s.setFullYear(s.getFullYear()+1),s.setMonth(0),s.setDate(0),t.to=moment(s).format(a);break;case"next_yearOption":(s=new Date).setFullYear(s.getFullYear()+1),s.setDate(1),s.setMonth(0),t.from=moment(s).format(a),s.setFullYear(s.getFullYear()+1),s.setMonth(0),s.setDate(0),t.to=moment(s).format(a)}return t}},{key:"generateAdvFilterDates",value:function(e){var t=document.querySelector("#".concat(e,"_dateoption")).value,a=(new Date,document.querySelector("#".concat(e,"_from"))),s=document.querySelector("#".concat(e,"_to")),o=axProcessObj.getDatesBasedonSelection(t);a.value=axProcessObj.convertDateFormat(o.from),s.value=axProcessObj.convertDateFormat(o.to),"customOption"==t?(a.disabled=!1,s.disabled=!1,a.classList.add("disabledDate"),s.classList.add("disabledDate")):(a.disabled=!0,s.disabled=!0,a.classList.remove("disabledDate"),s.classList.remove("disabledDate"))}},{key:"validateDateRange",value:function(e){var t=document.getElementById(e+"_from"),a=document.getElementById(e+"_to"),s=t.value,o=a.value;if(s&&o){var r=parseDate(s),n=parseDate(o);if(!r||!n)return void alert("Invalid date format.");n<r&&(alert('The "To" date cannot be earlier than the "From" date.'),a.value="")}}},{key:"getFieldDataType",value:function(e){return axProcessObj._entity.inValid(e.cdatatype)?"n"==e.fdatatype?"Number":"d"==e.fdatatype?"Date":"c"==e.fdatatype?"Text":"i"==e.fdatatype?"Image":"t"==e.fdatatype?"Large Text":"Text":e.cdatatype}},{key:"updateFilterLayout",value:function(e,t){filterChanged=!0,$("#dvModalFilter").children().each(function(){for(var t=$(this).attr("data-type"),a=$(this).find("div select"),s=a.attr("id"),o=a.attr("data-field"),r=$(this).find("div input"),n=r.attr("id"),i=0,c=Object.entries(e);i<c.length;i++){var l=_slicedToArray(c[i],2),d=l[0],u=l[1];if(s===d||o===d||n===d){var p=u.split(",")[1],m=$("#".concat(s));switch(t){case"DropDown":if(m.prop("multiple")){var h=p.split(";");m.val(h).trigger("change")}else m.val(p).trigger("change");break;case"Simple Text":r.val(p);break;case"Date":if("modifiedon_dateoption"===s){var f=$("#modifiedon_from"),v=$("#modifiedon_to"),y=getDatesBasedonSelection(p);f.val(y.from),v.val(y.to),m.val(p).trigger("change"),"customOption"===p?(f.prop("disabled",!1).addClass("disabledDate"),v.prop("disabled",!1).addClass("disabledDate")):(f.prop("disabled",!0).removeClass("disabledDate"),v.prop("disabled",!0).removeClass("disabledDate"))}break;case"Numeric":case"Auto Generate":r.val(p)}break}}}),e.pillText&&$("#filterGroupName").val(e.pillText)}},{key:"navigateToRecordWithKeyboard",value:function(e){var t=Array.from(document.querySelectorAll(".listrow .tasktitle")),a=(document.querySelector(".list-container"),t.findIndex(function(e){return e.classList.contains("taskRowClicked")}));if(-1===a&&t.length>0)return t[a=0].classList.add("taskRowClicked"),t[a].click(),t[a].closest(".listrow").style.outline="1px solid black",void setTimeout(function(){t[a].closest(".listrow").scrollIntoView({behavior:"smooth",block:"start"});var e=document.querySelector(".Page-Title-Bar");if(e){var s=e.offsetHeight||0;window.scrollBy(0,-s)}},0);var o="next"===e?a+1:a-1;o>=0&&o<t.length?(t[a].classList.remove("taskRowClicked"),t[a].closest(".listrow").style.outline="none",t[o].classList.add("taskRowClicked"),t[o].click(),t[o].closest(".listrow").style.outline="1px solid black",setTimeout(function(){t[o].closest(".listrow").scrollIntoView({behavior:"smooth",block:"start"});var e=document.querySelector(".Page-Title-Bar");if(e){var a=e.offsetHeight||0;window.scrollBy(0,-a)}},0),s):showAlertDialog("info","next"===e?"No more Next records.":"No more Previous records.")}},{key:"getRowIcon",value:function(e){var t="",a="";if("PEG"===e.rectype){if(e.taskstatus)switch(e.taskstatus.toUpperCase()){case"RETURNED":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" style="color:blueviolet" >reply</span>';break;case"WITHDRAWN":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" style="color:red" >cancel</span>';break;case"APPROVED":a='<span class="badge  badge-light-success fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" style="color:#50cd89" >check_circle</span>';break;case"REJECTED":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" style="color:red" >cancel</span>';break;case"CHECKED":a='<span class="badge  badge-light-success fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" style="color:#50cd89" >check_box</span>';break;case"MADE":a="",t='<span class="material-icons" >done</span>';break;case"SKIPPED":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons text-primary" >skip_next</span>';break;case"SENT":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.taskstatus.charAt(0).toUpperCase()+e.taskstatus.slice(1),"</span>"),t='<span class="material-icons" >skip_next</span>';break;default:a="",t='<span class="material-icons" title="PEG">assignment</span>'}else if(e.tasktype)switch(e.tasktype.toUpperCase()){case"APPROVE":a="",t='<span class="material-icons" >task</span>';break;case"CACHED SAVE":a="",t='<span class="material-icons" >save</span>';break;case"CHECK":a="",t='<span class="material-icons" >check</span>';break;case"MAKE":a="",t='<span class="material-icons" >construction</span>';break;case"EXPORT":a="",t='<span class="material-icons" >import_export</span>';break;case"REMINDERS":a="",t='<span class="material-icons" >notifications</span>';break;default:a="",t='<span class="material-icons" title="PEG">assignment</span>'}}else if("MSG"===e.rectype&&e.msgtype)switch(e.msgtype.toUpperCase()){case"EXPORT EXCEL1":a='<span class="badge  badge-light-primary fw-bold ">Export Excel</span>',t='<span class="material-icons" >file_copy</span>';break;case"EXPORT PDF":a='<span class="badge  badge-light-primary fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >picture_as_pdf</span>';break;case"EXPORT WORD":a='<span class="badge  badge-light-primary fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >article</span>';break;case"PERIODIC NOTIFICATION":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >alarm</span>';break;case"FORM NOTIFICATION":a="",t='<span class="material-icons" >notifications</span>';break;case"CCHED SAVE":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >save</span>';break;case"MESSAGE":a='<span class="badge  badge-light-success fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >message</span>';break;case"REMINDERS":a='<span class="badge  badge-light-danger fw-bold ">'.concat(e.msgtype.charAt(0).toUpperCase()+e.msgtype.slice(1),"</span>"),t='<span class="material-icons" >notifications</span>';break;default:a="",t='<span class="material-icons" title="Message">message</span>'}return{iconHtml:t,tooltip:a}}},{key:"toggleRowBackground",value:function(e){var t=document.querySelectorAll(".listrow"),a=e.closest(".listrow");t.forEach(function(e){return e.classList.remove("bg-changed")}),a&&a.classList.add("bg-changed")}},{key:"navigateToRecord",value:function(e){var t=this,a=Array.from(document.querySelectorAll(".listrow .tasktitle")),s=a.findIndex(function(e){return e.classList.contains("taskRowClicked")});if(-1!==s){var o="next"===e?s+1:s-1;if(o>=0&&o<a.length)a[o].click();else{var r=document.getElementById("body_Container");if("next"===e&&axProcessObj.isScrollAtBottomWithinDiv(r))this.isFetching||(this.isFetching=!0,axProcessObj.pageNo++,axProcessObj.fetchProcessList("task","scroll"),setTimeout(function(){t.isFetching=!1;var e=Array.from(document.querySelectorAll(".listrow .tasktitle"));if(e.length>a.length){var s=e.findIndex(function(e,t){return t===o});-1!==s?e[s].click():showAlertDialog("info","No more Next records.")}else showAlertDialog("info","No more Next records.")},500));else showAlertDialog("info","next"===e?"No more Next records.":"No more Previous records.")}}else showAlertDialog("info","No currently selected task to navigate from.")}},{key:"toggleCheckbox",value:function(){document.querySelector(".maincheckbox").addEventListener("click",function(e){var t=e.currentTarget;t.classList.toggle("selectclicked"),document.querySelectorAll(".checkbox-wrapper").forEach(function(e){var a=e.querySelector(".user"),s=e.querySelector(".task-checkbox");s.classList.toggle("selectclicked"),t.classList.contains("selectclicked")?(s.setAttribute("checked",!0),a.style.display="none",s.style.visibility="visible",t.style.display="blockwindow.top"):(s.removeAttribute("checked"),a.style.display="flex",s.style.visibility="hidden",t.style.display="none",document.querySelector('.selectbtn[data-kt-menu-attach="parent"]').classList.remove("toggleclicked"))})})}},{key:"toggleList",value:function(){document.getElementById("collapseicon").addEventListener("click",function(){var e,t=document.getElementById("PROFLOW_Left"),a=document.getElementById("PROFLOW_Right"),s=document.getElementById("nextrecord"),o=document.getElementById("previousrecord");t.classList.toggle("collapsed"),document.querySelector(".maincheckbox").style.display="none";var r=Array.from(document.querySelectorAll(".listrow"));if(e=r.filter(function(e){var t=e.querySelector(".tasktitle");return t&&t.classList.contains("taskRowClicked")}),t.classList.contains("collapsed")){var n=null,i=r.find(function(e){return"1"===e.getAttribute("data-index")});i&&0==e.length&&(n=i.querySelector(".tasktitle"))&&(console.log("Triggering click for taskTitle inside listRow with data-index: 1"),n.click()),t.classList.add("d-none"),a.classList.remove("col-xl-8"),a.classList.add("col-xl-12"),this.setAttribute("data-bs-title","Show record List"),this.setAttribute("data-bs-toggle","tooltip"),this.setAttribute("data-bs-placement","bottom");var c=bootstrap.Tooltip.getInstance(this);c&&c.dispose(),new bootstrap.Tooltip(this),s.classList.remove("d-none"),o.classList.remove("d-none")}else{if(1==e.length){var l=e[0].querySelector(".tasktitle");l&&(console.log("Scrolling to the taskTitle in the filtered row"),setTimeout(function(){l.scrollIntoView({behavior:"smooth",block:"start"});var e=document.getElementsByClassName("Page-Title-Bar").offsetHeight;window.scrollBy(10,-e)},0))}t.classList.remove("d-none"),a.classList.remove("col-xl-12"),a.classList.add("col-xl-8"),this.setAttribute("data-bs-title","Hide record List"),this.setAttribute("data-bs-toggle","tooltip"),this.setAttribute("data-bs-placement","bottom");var d=bootstrap.Tooltip.getInstance(this);d&&d.dispose(),new bootstrap.Tooltip(this),s.classList.add("d-none"),o.classList.add("d-none")}})}},{key:"initializeTooltips",value:function(){document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(function(e){e.getAttribute("data-bs-title")||e.removeAttribute("data-bs-title");var t=bootstrap.Tooltip.getInstance(e);t&&t.dispose(),new bootstrap.Tooltip(e)})}},{key:"initializeDatePickers",value:function(){$("#pdFilFrom, #pdFilTo").flatpickr({dateFormat:"d-M-Y",enableTime:!1})}},{key:"setupSelectAllTasks",value:function(){$(document).on("click",".all-task",function(e){var t=e.currentTarget.checked,a=document.querySelector("#pd_all_tasks");KTMenu.getInstance(a).element.children.forEach(function(e,a){var s=e.querySelector(".menu-task");s&&(s.checked=t)}),$(".all-task-text").text(t?"Unselect All":"Select All")}),$(document).on("click",".menu-task",function(){var e=document.querySelectorAll(".menu-task"),t=document.querySelectorAll(".menu-task:checked"),a=document.querySelector(".all-task"),s=$(".all-task-text");e.length===t.length?(a.checked=!0,s.text("Unselect All")):(a.checked=!1,s.text("Select All"))})}},{key:"generateTaskHTML",value:function(e){var t,a;this.count++;var s=axProcessObj.formatEventDate(e.eventdatetime),o=(e.displaytitle&&e.displaytitle.charAt(0).toUpperCase(),"active"===(null===(t=e.cstatus)||void 0===t?void 0:t.toLowerCase())?"active-row":"completed-row"),r=(null===(a=e.fromuser)||void 0===a?void 0:a.toLowerCase())===window.top.mainUserName?" &nbsp; ":e.fromuser,n=document.querySelector('.selectbtn[data-kt-menu-attach="parent"]').classList.contains("selectclicked"),i=this.getRowIcon(e);return n?'\n            <div class="container listrow '.concat(o,'" data-status="').concat(e.cstatus,'" data-index=').concat(this.count,'>\n            <div class="row">\n    \n                <div class="col-2 checkbox-wrapper">\n                <div>  <input type="checkbox" class="task-checkbox selectclicked" id="checkbox-').concat(e.taskid,'" checked\n                            style="visibility:visible"></div>\n                        <div class="user" style="display:none;">').concat(i.iconHtml,'</div>\n                </div>\n                <div class="col-7 col-content" style="').concat(e.displaycontent?"":"display: flex; align-items: center; justify-content: center;",'">\n                    <div>\n                        <a href="javascript:void(0)" class="tasktitle ProcessFlow_New-List-Title Procurement-list"\n                            onclick="axProcessObj.openTask(this, \'').concat(e.taskname,"','").concat(e.tasktype,"','").concat(e.transid,"','").concat(e.keyfield,"','").concat(e.keyvalue,"','").concat(e.recordid,"','").concat(e.taskid,"', '").concat(e.indexno,"','").concat(e.hlink_transid,"','").concat(e.hlink_params,"','").concat(e.processname,"','").concat(e.msgtype,"', 'LeftPanel');axProcessObj.toggleRowBackground(this) \"\n                            data-caption=\"").concat(e.taskname,'" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="').concat(e.displaytitle?e.displaytitle:"",'">\n                            ').concat(e.displaytitle||e.msgtype||"Untitled Task",'\n                        </a>\n                        </div>\n                        <div class="taskcontent">').concat(e.displaycontent||"",'</div>\n                       <div class="rowicons">').concat(i.tooltip,'</div>\n                   \n                </div>\n                    <div class="col-3 timespace">\n                    <div class="nametime">').concat(r,'</div>\n                        <div class="nametime" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="').concat(s,'">').concat(s,"\n                        </div>\n                    </div>\n                </div>\n            </div>"):'\n        <div class="container listrow '.concat(o,'"data-status="').concat(e.cstatus,'" data-index=').concat(this.count,'>\n        <div class="row">\n            <div class="col-2 checkbox-wrapper">\n                <div><input type="checkbox" class="task-checkbox" id="checkbox-').concat(e.taskid,'"></div>\n                <div class="user">').concat(i.iconHtml,'</div>\n\n            </div>\n            <div class="col-7" style="').concat(e.displaycontent?"":"display: flex; align-items: center; justify-content: center;",'">\n                <div>\n                    <a href="javascript:void(0)" class="tasktitle ProcessFlow_New-List-Title Procurement-list" \n                    onclick="axProcessObj.openTask(this, \'').concat(e.taskname,"','").concat(e.tasktype,"','").concat(e.transid,"','").concat(e.keyfield,"','").concat(e.keyvalue,"','").concat(e.recordid,"','").concat(e.taskid,"', '").concat(e.indexno,"','").concat(e.hlink_transid,"','").concat(e.hlink_params,"','").concat(e.processname,"','").concat(e.msgtype,"', 'LeftPanel');axProcessObj.toggleRowBackground(this) \"\n                    data-caption=\"").concat(e.taskname,'" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="').concat(e.displaytitle?e.displaytitle:"",'">\n                        ').concat(e.displaytitle||e.msgtype||"Untitled Task",'\n                    </a>\n                    </div>\n                    <div class="taskcontent">').concat(e.displaycontent||"",'</div>\n                    <div class="rowicons">').concat(i.tooltip,'</div>\n           \n            </div>\n            <div class="timespace col-3">\n                <div class="nametime">').concat(r,'</div>\n                <div class="nametime" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="').concat(s,'">').concat(s,"</div>\n\n            </div>\n        \n        </div>\n    </div>")}},{key:"createAccordionForTimeframe",value:function(e,t,a){var s=this,o="Today"===e?'style="display: none;"':"",r='\n            <div class="accordion accordion-flush"  id="section-'.concat(e.replace(/\s+/g,""),'">\n                <div class="accordion-item">\n                    <h2 class="accordion-header" id="heading-').concat(e,'" ').concat(o,'>\n                        <button class="accordion-button" type="button"  \n                            data-bs-target="#collapse-').concat(e.replace(/\s+/g,""),'" aria-expanded="false" \n                            aria-controls="collapse-').concat(e,'" >\n                            ').concat(e,'\n                        </button>\n                    </h2>\n                    <div id="collapse-').concat(e.replace(/\s+/g,""),'" class="accordion-collapse collapse show" \n                        aria-labelledby="heading-').concat(e,'" data-bs-parent="#section-').concat(e.replace(/\s+/g,""),'">\n                        <div class="accordion-body">\n                            ').concat(t.map(function(e){return s.generateTaskHTML(e)}).join(""),"\n                        </div>\n                    </div>\n                </div>\n            </div>");document.getElementById("plistContent").insertAdjacentHTML("beforeend",r);var n=document.getElementById("section-".concat(e.replace(/\s+/g,""))),i=null==n?void 0:n.previousElementSibling,c=null==i?void 0:i.querySelector(".accordion-button");i&&null!=c&&(c?(c.classList.add("show-collapse-button"),c.setAttribute("data-bs-toggle","collapse")):(c.classList.remove("show-collapse-button"),c.removeAttribute("data-bs-toggle","collapse")))}},{key:"showNoMoreRecords",value:function(){var e=document.getElementById("plistContent");if(!e.querySelector(".no-more-records")){var t=document.createElement("div");t.textContent="No more records to display.",t.className="no-more-records",t.style.color="red",t.style.margin="10px",t.style.padding="10px",t.style.textAlign="center",e.appendChild(t)}var a=document.getElementById("section-Previousrecords");null==a||a.querySelector(".accordion-button").classList.add("show-collapse-button"),null==a||a.querySelector(".accordion-button").setAttribute("data-bs-toggle","collapse")}},{key:"processListData",value:function(e,t){try{var a="",s=e.eventdatetime.split(" ")[0],o=e.reduce(function(e,t){var a=axProcessObj.getTimeframe(s);return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.keys(o).forEach(function(e,t){var s="section-".concat(t),r="collapse-".concat(t);a+='\n                      <div class="accordion accordion-flush" id="'.concat(s,'">\n                        <div class="accordion-item">\n                          <h2 class="accordion-header" id="heading-').concat(t,'">\n                            <button class="accordion-button" type="button" data-bs-target="#').concat(r,'" aria-expanded="false" aria-controls="').concat(r,'">\n                              ').concat(e,' \n                            </button>\n                          </h2>\n                          <div id="').concat(r,'" class="accordion-collapse collapse" aria-labelledby="heading-').concat(t,'" data-bs-parent="#').concat(s,'">\n                            <div class="accordion-body">\n                              ').concat(o[e].map(function(e){return"<p>Content for ".concat(e.date,"</p>")}).join(""),"\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ")}),a}catch(r){return console.error("Error processing task data:",r.message),"<p>Error processing task data.</p>"}}},{key:"getProStatusDetails",value:function(e,t){var a={counter:0,returnProStatus:""};"Task Name"==e.caption?(a.counter=1,a.icon=t.displayicon,a.taskType=this.processVars.pStatus[t.tasktype.toLowerCase()]||"make",a.title=""):"Next Step"==e.caption&&(a.counter=""!=t.nexttask?t.nexttask.split(",").length:0,a.nextTask=t.nexttask.split(","));for(var s=0;s<a.counter;)"Next Step"==e.caption&&(a.curTask=a.nextTask[s].split("~"),a.icon=a.curTask[0],a.taskType=this.processVars.pStatus[a.curTask[1].toLowerCase()]||"make",a.title=a.curTask[2]),a.returnProStatus+='<button class="btn btn-icon btn-sm '.concat(a.taskType.bgColor," border ").concat(a.taskType.borderColor,' shadow-sm flex-column me-2" ').concat(""!=a.title?'title="'.concat(a.title,'"'):"",'>\n                <span class="blinker bullet bullet-dot h-8px w-8px position-relative bottom-25 start-25 animation-blinkz ').concat(a.taskType.color,'"></span>\n                <span class="material-icons material-icons-style material-icons-3 mt-n2 ').concat(a.taskType.iconColor,'">').concat(a.icon,"</span>\n            </button>"),s++;return a.returnProStatus}},{key:"taskFilter",value:function(e){var t,a;ShowDimmer(!0);var s={user:document.getElementById("pdFilUser").value||"",from:(null===(t=document.getElementById("pdFilFrom").value)||void 0===t?void 0:t.replaceAll("-","/"))||"",to:(null===(a=document.getElementById("pdFilTo").value)||void 0===a?void 0:a.replaceAll("-","/"))||""};if(s.allTrs=document.querySelectorAll("#pendingList tr, #completedList tr"),"reset"==e)document.getElementById("pdFilUser").value="",document.getElementById("pdFilFrom").value="",document.getElementById("pdFilTo").value="","pending"==$("#PROFLOW_Left li a.active").attr("id")?this.fetchProcessList("ProcessList"):this.fetchProcessList("ProcessList","TaskCompletion");else if("filter"==e&&""==(s&&(s.user||s.from||s.to)))ShowDimmer(!1),this.catchError("Filter parameters cannot be left empty..!!");else{var o,r=$("#PROFLOW_Left li a.active").attr("id"),n=this;"../aspx/AxPEG.aspx/AxGetFilteredActiveTasks",o={filterType:r,pageNo:_pageno,pageSize:_pagesize,fromuser:s.user,processname:"",fromdate:s.from,todate:s.to,searchtext:""},this.callAPI("../aspx/AxPEG.aspx/AxGetFilteredActiveTasks",o,!0,function(e){if(e.success){var t=JSON.parse(e.response),a=n.dataConvert(t,"ARM");TaskCount=a.result.count,void 0!==r&&"completed"==r?"undefined"!=typeof a.result.completedtasks&&a.result.completedtasks.length>0?(completedtasksJson=a.result.completedtasks,n.showProcessList("completed")):showAlertDialog("warning","No task available."):"undefined"!=typeof a.result.pendingtasks&&a.result.pendingtasks.length>0?(pendingtasksJson=a.result.pendingtasks,n.showProcessList("pending")):showAlertDialog("warning","No task available."),document.getElementById("pdFilUser").value="",document.getElementById("pdFilFrom").value="",document.getElementById("pdFilTo").value="",ShowDimmer(!1)}else ShowDimmer(!1)})}}},{key:"taskSearch",value:function(e){ShowDimmer(!0);var t={searchVal:document.getElementById("advTextSearch").value||""};if("reset"==e)document.getElementById("advTextSearch").value="","pending"==$("#PROFLOW_Left li a.active").attr("id")?this.fetchProcessList("ProcessList"):this.fetchProcessList("ProcessList","TaskCompletion");else if("search"==e&&""==(t&&t.searchVal))ShowDimmer(!1),this.catchError("Search cannot be left empty..!!");else{var a,s=$("#PROFLOW_Left li a.active").attr("id"),o=this;"../aspx/AxPEG.aspx/AxGetFilteredActiveTasks",a={filterType:s,pageNo:_pageno,pageSize:_pagesize,fromuser:"",processname:"",fromdate:"",todate:"",searchtext:t.searchVal},this.callAPI("../aspx/AxPEG.aspx/AxGetFilteredActiveTasks",a,!0,function(e){if(e.success){var t=JSON.parse(e.response),a=o.dataConvert(t,"ARM");TaskCount=a.result.count,void 0!==s&&"completed"==s?"undefined"!=typeof a.result.completedtasks&&a.result.completedtasks.length>0?(completedtasksJson=a.result.completedtasks,o.showProcessList("completed")):showAlertDialog("warning","No task available."):"undefined"!=typeof a.result.pendingtasks&&a.result.pendingtasks.length>0?(pendingtasksJson=a.result.pendingtasks,o.showProcessList("pending")):showAlertDialog("warning","No task available."),document.getElementById("advTextSearch").value="",ShowDimmer(!1)}else ShowDimmer(!1)})}}},{key:"showProgress",value:function(e){var t,a=this;setTimeout(function(){axProcessObj.beforeLoad()},100);var s=this,o={};var r=(null==e?void 0:null===(t=e.dataset)||void 0===t?void 0:t.taskid)||this.taskId;if(void 0!==e)o={processName:this.processName,keyField:this.keyField,keyValue:this.keyValue};else{var n=$($(".Procurement-list")[0]);o={processName:n.data("processname"),keyField:n.data("keyfield"),keyValue:n.data("keyvalue")},r=n.data("taskid"),this.processName=n.data("processname")}this.callAPI("../aspx/AxPEG.aspx/AxGetProcess",o,!0,function(e){if(e.success){s.hideDefaultCenterPanel(),ShowDimmer(!1);var t,o,n,i=JSON.parse(e.response),c=s.dataConvert(i,"ARM"),l=1;if(document.querySelector("#horizontal-processbar").innerHTML="",c.forEach(function(e,t){var s,o=e.tasktype.toUpperCase();-1==["IF","ELSE","ELSE IF","END"].indexOf(o)&&("1"==e.indexno&&a.inValid(e.taskstatus)?e.taskstatus="pending":"Active"==e.taskstatus&&(e.taskstatus="pending"),a.isNullOrEmpty(e.taskstatus)&&e.indexno>1?e.taskstatus="disabled":["APPROVED","REJECTED","RETURNED","CHECKED","MADE"].indexOf(null===(s=e.taskstatus)||void 0===s?void 0:s.toUpperCase())>-1&&(e.taskstatus="completed"),a.isNullOrEmpty(e.recordid)&&(e.recordid="0"),e.sno=l,l++,document.querySelector("#horizontal-processbar").insertAdjacentHTML("beforeend"," ".concat(Handlebars.compile(a.horizontalStepHtml)(e)," ")))}),a.taskCompleted){if(a.taskCompleted=!1,!a.getNextTaskInProcess())if(a.inValid(document.querySelector(".horizontal-steps.pending"))){if(!a.inValid(document.querySelector(".horizontal-steps"))){var d,u,p;a.calledFrom="ProgressBar",null===(d=document.querySelector(".horizontal-steps"))||void 0===d||d.click(),null===(u=document.querySelector(".horizontal-steps"))||void 0===u||u.scrollIntoView(),r=null===(p=document.querySelector(".horizontal-steps.pending").dataset)||void 0===p?void 0:p.taskid}}else a.calledFrom="ProgressBar",null===(t=document.querySelector(".horizontal-steps.pending"))||void 0===t||t.click(),null===(o=document.querySelector(".horizontal-steps.pending"))||void 0===o||o.scrollIntoView(),r=null===(n=document.querySelector(".horizontal-steps.pending").dataset)||void 0===n?void 0:n.taskid}else if(a.inValid(a.taskId))if(a.inValid(a.target)){var m;a.calledFrom="ProgressBar";var h,f,v=".horizontal-steps";if(a.inValid(document.querySelector(".horizontal-steps.pending"))){if(!a.inValid(document.querySelector(v))){var y,g;null===(y=document.querySelector(v))||void 0===y||y.click(),null===(g=document.querySelector(v))||void 0===g||g.scrollIntoView()}}else null===(h=document.querySelector(v))||void 0===h||h.click(),null===(f=document.querySelector(".horizontal-steps.pending"))||void 0===f||f.scrollIntoView();a.inValid(r)&&(r=null===(m=document.querySelector(v).dataset)||void 0===m?void 0:m.taskid),a.target=null}else{var k;a.calledFrom="ProgressBar";var b,w,S='.horizontal-steps.pending[data-taskname="'.concat(a.target,'"]'),x='.horizontal-steps[data-taskname="'.concat(a.target,'"]');if(a.inValid(document.querySelector(S))){if(!a.inValid(document.querySelector(x))){var T,A;null===(T=document.querySelector(x))||void 0===T||T.click(),null===(A=document.querySelector(x))||void 0===A||A.scrollIntoView()}}else null===(b=document.querySelector(x))||void 0===b||b.click(),null===(w=document.querySelector(S))||void 0===w||w.scrollIntoView();a.inValid(r)&&(r=null===(k=document.querySelector(x).dataset)||void 0===k?void 0:k.taskid),a.target=null}else{a.calledFrom="ProgressBar";var P,D,O,L='.horizontal-steps[data-taskid="'.concat(a.taskId,'"]');if(!a.inValid(document.querySelector(L)))null===(P=document.querySelector(L))||void 0===P||P.click(),null===(D=document.querySelector(L))||void 0===D||D.scrollIntoView(),a.inValid(r)&&(r=null===(O=document.querySelector(L).dataset)||void 0===O?void 0:O.taskid);a.target=null}s.inValid(r)||s.setActiveInList(r),setTimeout(function(){axProcessObj.afterLoad()},100)}else ShowDimmer(!1)})}},{key:"showProgressNew",value:function(){var e=this;setTimeout(function(){axProcessObj.beforeLoad()},100);var t,a=this;t={processName:this.processName,taskType:this.taskType,taskId:this.taskId,keyValue:this.keyValue},this.callAPI("../aspx/AxPEG.aspx/AxPEGGetTaskDetails",t,!0,function(t){if(t.success){var s=JSON.parse(t.response),o=a.dataConvert(s,"ARM");if((processflowJson=o.result.processflow).length>0){var r=processflowJson,n=1;document.querySelector("#horizontal-processbar").innerHTML="",r.forEach(function(t,a){var s,o=t.tasktype.toUpperCase();-1==["IF","ELSE","ELSE IF","END"].indexOf(o)&&("1"==t.indexno&&e.inValid(t.taskstatus)?t.taskstatus="pending":"Active"==t.taskstatus&&(t.taskstatus="pending"),e.isNullOrEmpty(t.taskstatus)&&t.indexno>1?t.taskstatus="disabled":["APPROVED","REJECTED","RETURNED","CHECKED","MADE"].indexOf(null===(s=t.taskstatus)||void 0===s?void 0:s.toUpperCase())>-1&&(t.taskstatus="completed"),e.isNullOrEmpty(t.recordid)&&(t.recordid="0"),t.sno=n,n++,document.querySelector("#horizontal-processbar").insertAdjacentHTML("beforeend"," ".concat(Handlebars.compile(e.horizontalStepHtml)(t)," ")))}),setTimeout(function(){axProcessObj.afterLoad()},100)}else ShowDimmer(!1)}else ShowDimmer(!1)})}},{key:"beforeLoad",value:function(){}},{key:"afterLoad",value:function(){}},{key:"showTimeLine",value:function(){(axTimeLineObj=new ProcessTimeLine).keyvalue=this.keyValue,axTimeLineObj.processName=this.processName,this.inValid(axTimeLineObj.keyvalue)||"NA"==axTimeLineObj.keyvalue||axTimeLineObj.getTimeLineData()}},{key:"showList",value:function(){document.querySelectorAll("#showList,#PROFLOW-profile-container").forEach(function(e){e.classList.add("d-none")}),document.querySelectorAll("#plistAccordion,#showProgress").forEach(function(e){e.classList.remove("d-none")})}},{key:"showDefaultList",value:function(){document.querySelectorAll("#showList,#PROFLOW-profile-container,#showProgress").forEach(function(e){e.classList.add("d-none")}),document.querySelectorAll("#plistAccordion").forEach(function(e){e.classList.remove("d-none")})}},{key:"refreshCards",value:function(e,t){this.inValid(e)||$.ajax({url:"../aspx/AxPEG.aspx/AxRefreshCardsData",type:"POST",cache:!1,async:!0,data:JSON.stringify({cardsIds:e.join(","),cardsParams:t}),dataType:"json",contentType:"application/json",success:function(e){if(e.d&&""!=e.d){var t=JSON.parse(e.d);cardsData.value=JSON.parse(cardsData.value);var a=cardsData.value.concat(t.result.cards).reduce(function(e,t){var a=e.find(function(e){return e.axp_cardsid===t.axp_cardsid});return a?(a.cardsql=t.cardsql,e):e.concat([t])},[]);if(cardsData.value=JSON.stringify(a),cardsDesign.value="",""!=xmlMenuData){xmlMenuData=xmlMenuData.replace(/&apos;/g,"'");var s=parseXml(xmlMenuData),o=xml2json(s,"");menuJson=JSON.parse(o)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:menuJson}),appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==cardsData.value?ReverseCheckSpecialChars(cardsData.value):"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),design:(JSON.parse(""!==cardsDesign.value?cardsDesign.value:"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),enableMasonry:cardsDashboardObj.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:".cardsPlot",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var r=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:cardsDashboardObj.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:cardsDashboardObj.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=r.cardsPage}else showAlertDialog("error","Error while loading cards dashboard..!!")},error:function(e){showAlertDialog("error","Error while loading cards dashboard..!!")},failure:function(e){showAlertDialog("error","Error while loading cards dashboard..!!")}})}}]),AxProcessFlow}(),axProcessTreeObj,AxProcessTree=function(){function e(t){_classCallCheck(this,e),this.definitionFetched=!1,this.dataSources=[],this.processName=t,this.stepHtml='\n            <div class="step">\n                <div>\n                    <div class="circle ">\n                        <i class="fa fa-check"></i>\n                        <span class="Emp-steps-counts">{{sno}}</span>\n                    </div>\n                    <div class="line"></div>\n                </div>\n                <div class="Task-process-wrapper">\n                    {{groupNameHtml}}\n                    {{taskCaptionHtml}}\n                </div>\n            </div>',this.groupNameHtml='\n            <div class="title">\n                <a href="javascript:void(0)">{{taskgroup}}</a>\n                <span data-groupname="{{taskgroup}}" class="Process-flow accordion-icon rotate">\n                    <span  class="material-icons material-icons-style material-icons-2">chevron_right</span>                    \n                </span>\n            </div>',this.taskCaptionHtml='<div class="process-sub-flow" data-groupname="{{taskgroup}}" data-tasktype="{{tasktype}}">',this.taskCaptionHtml+='<div class="positionRel Task-process-list">',this.taskCaptionHtml+='<a href="javascript:void(0)" onclick="return false;">{{taskname}}</a>',this.taskCaptionHtml+="</div></div>"}return _createClass(e,[{key:"fetchProcessDefinition",value:function(e){var t=this,a={processName:this.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetProcessDefinition",a,!1,function(a){if(a.success){var s=JSON.parse(a.response),o=t.dataConvert(s,"ARM");t.dataSources[e]=o,t.definitionFetched=!0}})}},{key:"showProcessTree",value:function(){var e=this;try{var t=new BSModal("modal_ProcessTree","",'<div class="PROFLOW-Info-Steps ax-data accordion arrows" id="procflow-steps"></div>',function(t){ShowDimmer(!0),e.definitionFetched||e.fetchProcessDefinition("Process"),e.showProcessDefinition(),ShowDimmer(!1)},function(e){});t.changeSize("md"),t.hideHeader(),t.hideFooter(),t.showFloatingClose()}catch(a){showAlertDialog("error",a.message)}}},{key:"showProcessDefinition",value:function(){var e=this;if(""==document.querySelector("#procflow-steps").innerHTML){this.processFlowObj={},this.dataSources.Process.forEach(function(t,a){e.isUndefined(e.processFlowObj[t.taskgroup])&&(e.processFlowObj[t.taskgroup]={},e.processFlowObj[t.taskgroup].group_name_html="",e.processFlowObj[t.taskgroup].task_caption_html=""),e.isNullOrEmpty(t.taskstatus)&&t.indexno>1&&(t.taskstatus="disabled"),e.isNullOrEmpty(t.recordid)&&(t.recordid="0");var s=e.processFlowObj[t.taskgroup];s.indexno=t.indexno,s.group_name_html=Handlebars.compile(e.groupNameHtml)(t),s.task_caption_html+=Handlebars.compile(e.taskCaptionHtml)(t)}),document.querySelector("#procflow-steps").innerHTML="";for(var t=1,a=0,s=Object.entries(this.processFlowObj);a<s.length;a++){var o=_slicedToArray(s[a],2),r=(o[0],o[1]);document.querySelector("#procflow-steps").insertAdjacentHTML("beforeend"," ".concat(this.stepHtml.replace("{{sno}}",t).replace("{{groupNameHtml}}",r.group_name_html).replace("{{taskCaptionHtml}}",r.task_caption_html)," ")),t++}ShowDimmer(!1),$(".accordion-icon").click(function(){var e=$(this).attr("data-groupname");$(this).toggleClass("rotate"),$('.process-sub-flow[data-groupname="'.concat(e,'"]')).toggle()})}}},{key:"callAPI",value:function(e,t,a,s){var o=this,r=new XMLHttpRequest;r.open("POST",e,a),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.isAxpertFlutter&&(r.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),r.onreadystatechange=function(){4==this.readyState&&(200==this.status?s({success:!0,response:this.responseText}):(o.catchError(this.responseText),s({success:!1,response:this.responseText})))},r.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(a){ShowDimmer(!1),this.catchError(a.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(a){ShowDimmer(!1),this.catchError(a.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}}]),e}(),axTimeLineObj,ProcessTimeLine=function(){function e(){_classCallCheck(this,e),this.keyvalue="",this.processName="",this.make='<li class="make">                                   \n                    <p class="T-Desc">{{taskname}}#{{keyvalue}}</p>\n \t\t    <p class="T-Heading">{{taskfromuser}}</p>\n \t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.check='<li class="check">\n                    <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.approve='<li class="approve">\n                   <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>'}return _createClass(e,[{key:"getTimeLineData",value:function(){ShowDimmer(!0);var e=this,t={keyValue:e.keyvalue,processName:e.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetTimelineData",t,!0,function(t){if(t.success){var a=JSON.parse(t.response),s=e.dataConvert(a,"ARM");e.constructTimeline(s),ShowDimmer(!1)}else ShowDimmer(!1)})}},{key:"constructTimeline",value:function(e){var t=this;if(this.isUndefined(e)||0==e.length)document.querySelector(".Timel-sessions").classList.add("d-none"),document.querySelector("#nodata").classList.remove("d-none");else{document.querySelector("#nodata").classList.add("d-none"),document.querySelector(".Timel-sessions").classList.remove("d-none");var a="";document.querySelector(".Timel-sessions").innerHTML="",e.forEach(function(e){a+=Handlebars.compile(t[e.tasktype.toLowerCase()])(e)}),document.querySelector(".Timel-sessions").insertAdjacentHTML("beforeend",a)}}},{key:"callAPI",value:function(e,t,a,s){var o=this,r=new XMLHttpRequest;r.open("POST",e,a),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.isAxpertFlutter&&(r.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),r.onreadystatechange=function(){4==this.readyState&&(200==this.status?s({success:!0,response:this.responseText}):(o.catchError(this.responseText),s({success:!1,response:this.responseText})))},r.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(a){this.catchError(a.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(a){this.catchError(a.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}}]),e}();$(document).ready(function(){ShowDimmer(!0),(axProcessObj=new AxProcessFlow).init()});
